
<!DOCTYPE html>


<html lang="en" data-content_root="../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Module 4: Unsupervised Learning &#8212; WSU ML in Cybersecurity</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=c72df8c4" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=afe5de03"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/Module_4_Unsupervised_Learning';</script>
    <script src="../_static/custom.js?v=a4c55d5e"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Module 5: Anomaly and Intrusion Detection with Machine Learning" href="Module_5_Anomaly_and_Intrusion_Detection_with_Machine_Learning.html" />
    <link rel="prev" title="Module 3: Data Preprocessing and Features Selection" href="Module_3_Data_preprocessing_and_features_selection.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="WSU ML in Cybersecurity - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="WSU ML in Cybersecurity - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Exploring Machine Learning in Cybersecurity Workshop
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Module_0_Introduction_to_Jupyter_Notebook_and_Colab.html"><strong>Module 0:</strong> Introduction to Jupyter Notebook and Colab</a></li>



<li class="toctree-l1"><a class="reference internal" href="Module_1_Fundamentals_of_Machine_Learning.html"><strong>Module 1:</strong> Fundamentals of Machine Learning</a></li>

<li class="toctree-l1"><a class="reference internal" href="Module_2_Supervised_learning.html"><strong>Module 2:</strong> Supervised Learning</a></li>




<li class="toctree-l1"><a class="reference internal" href="Module_3_Data_preprocessing_and_features_selection.html"><strong>Module 3:</strong> Data Preprocessing and Features Selection</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Module 4</strong>: Unsupervised Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Module_5_Anomaly_and_Intrusion_Detection_with_Machine_Learning.html"><strong>Module 5:</strong> Anomaly and Intrusion Detection with Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Module_6_Generative_AI_for_Cyber_Security.html"><strong>Module 6:</strong> Generative AI for Cyber Security</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/WSU-AI-CyberSecurity/WSU-AI-CyberSecurity.github.io/blob/main/notebooks/Module_4_Unsupervised_Learning.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/Module_4_Unsupervised_Learning.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Module 4: Unsupervised Learning</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-and-segmentation">Clustering and Segmentation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-unsupervised-learning">Introduction to unsupervised learning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#types-of-machine-learning">Types of machine learning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#can-we-learn-without-targets">Can we learn without targets?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#labeled-vs-unlabeled-data">Labeled vs. Unlabeled data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-supervised-vs-unsupervised-learning">Example: Supervised vs unsupervised learning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-clustering">What is clustering?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-input-and-possible-output">Clustering: Input and (possible) output</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-what-is-correct-grouping">Example 1: What is “correct” grouping?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-applications">Common applications</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-exploration">Data exploration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-clustering">K-Means clustering</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-using-sklearn">K-Means using <code class="docutils literal notranslate"><span class="pre">sklearn</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-algorithm-main-idea">K-Means algorithm: Main idea</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-clustering-algorithm">K-Means clustering algorithm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initialization">Initialization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iterative-process">Iterative process</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-find-closest-centers">How to find closest centers?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#when-to-stop">When to stop?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-comment-on-initialization">A comment on initialization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-bad-initialization">Example: Bad initialization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-better-initialization">Example: Better initialization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-can-we-do-about-it">What can we do about it?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hyperparameter-tuning-for-the-number-of-clusters">Hyperparameter tuning for the number of clusters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#method-1-the-elbow-method">Method 1: The Elbow method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#method-2-the-silhouette-method">Method 2: The Silhouette method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-intra-cluster-distance-a">Mean intra-cluster distance (<span class="math notranslate nohighlight">\(a\)</span>)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-nearest-cluster-distance-b">Mean nearest-cluster distance (<span class="math notranslate nohighlight">\(b\)</span>)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#silhouette-distance-for-a-sample">Silhouette distance for a sample</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-silhouette-scores-to-select-the-number-of-clusters">Using Silhouette scores to select the number of clusters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-to-look-for-in-these-plots">What to look for in these plots?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#final-comments-summary-and-reflection">Final comments, summary, and reflection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#important-points-to-remember">Important points to remember</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-look-at-a-different-clustering-method">Let’s look at a different Clustering method!</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-gaussian-mixture-models-high-level">Introduction to Gaussian mixture models (high-level)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-does-it-work-high-level">How does it work? (high-level)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="module-4-unsupervised-learning">
<h1><strong>Module 4</strong>: Unsupervised Learning<a class="headerlink" href="#module-4-unsupervised-learning" title="Link to this heading">#</a></h1>
<p>In cybersecurity, the ability to detect and combat emerging threats is paramount. Unsupervised learning emerges as a powerful tool, offering innovative approaches to identifying patterns, anomalies, and potential risks without relying on labeled datasets.</p>
<p>Unsupervised learning stands in contrast to its supervised counterpart by operating without predefined labels. In the realm of cybersecurity, this potentially means exploring data without explicit knowledge of whether it represents normal behavior or potential threats. Unsupervised learning techniques unleash the potential to discover hidden insights, trends, and deviations that might otherwise go unnoticed.</p>
<p>The following are some examples of unsupervised learning in cybersecurity.</p>
<section id="clustering-and-segmentation">
<h2>Clustering and Segmentation<a class="headerlink" href="#clustering-and-segmentation" title="Link to this heading">#</a></h2>
<p>Unsupervised techniques are adept at clustering similar entities or grouping data points with shared characteristics. In cybersecurity, this facilitates the segmentation of network behavior, aiding in the identification of distinct user profiles or network segments.</p>
<p>Clustering involves the grouping of similar entities or data points that share common characteristics. In the context of cybersecurity, this could mean identifying clusters of network behavior that exhibit similar traits or patterns. These clusters might represent groups of users with similar access patterns, devices with comparable usage profiles, or network segments with analogous communication protocols.</p>
<center>
    <img style="max-width: 670px" src="https://www.researchgate.net/publication/351953193/figure/fig3/AS:11431281117150742@1675395484096/Supervised-and-unsupervised-machine-learning-a-Schematic-representation-of-an.png" />
</center>
<p>Segmentation, an outcome of effective clustering, provides a methodical breakdown of the overall system into distinct components or segments. In the cybersecurity realm, this segmentation is akin to carving out meaningful partitions within network behavior. Each segment encapsulates entities or activities that share specific attributes, allowing for a more granular understanding of the cybersecurity landscape.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">![</span><span class="w"> </span>-d<span class="w"> </span>wsu_workshop_utils<span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/wsu-ai-cyberSecurity/wsu_workshop_utils
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>mglearn<span class="w"> </span>plotly<span class="w"> </span>yellowbrick
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">from</span> <span class="nn">wsu_workshop_utils.plotting</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">cluster</span><span class="p">,</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_blobs</span>

<span class="kn">import</span> <span class="nn">mglearn</span>

<span class="c1"># plt.style.use(&quot;seaborn&quot;)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;font.size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/015c430b4f664d244d75a42888eeaa03e1a94fb01de761e7d7f0a79a232587de.png" src="../_images/015c430b4f664d244d75a42888eeaa03e1a94fb01de761e7d7f0a79a232587de.png" />
</div>
</div>
</section>
<section id="introduction-to-unsupervised-learning">
<h2>Introduction to unsupervised learning<a class="headerlink" href="#introduction-to-unsupervised-learning" title="Link to this heading">#</a></h2>
<p>In this module, we will look into foundamental unsupervised learning model to gain a solid understanding of unsupervised learning, specifically focusing on clustering. This session aims to clarify the unsupervised paradigm, its motivation, and the applications of clustering. Topics covered include the definition of the clustering problem, an overview of the K-Means algorithm with practical application using sklearn’s <code class="docutils literal notranslate"><span class="pre">KMeans</span></code>, and insights into the challenges of choosing the <strong>optimal number of clusters</strong>.</p>
<p>We will also have some practical exercises involve creating and interpreting Elbow plots and Silhouette plots. Later on we will also touch upon soft and hard cluster assignments, image clustering, and the impact of data representation on clustering outcomes. This session aims to provide you with a comprehensive foundation in unsupervised learning techniques for data analysis.</p>
<section id="types-of-machine-learning">
<h3>Types of machine learning<a class="headerlink" href="#types-of-machine-learning" title="Link to this heading">#</a></h3>
<p>The following are some typical learning problems that are actively being used in the internet and by various companies.</p>
<ul class="simple">
<li><p><strong>Supervised learning</strong> (<a class="reference external" href="https://support.google.com/a/answer/2368132?hl=en">Gmail spam filtering</a>)</p>
<ul>
<li><p>Training a model from input data and its corresponding targets to predict targets for new examples.</p></li>
</ul>
</li>
<li><p><strong>Unsupervised learning</strong> (this course) (<a class="reference external" href="https://news.google.com/">Google News</a>)</p>
<ul>
<li><p>Training a model to find patterns in a dataset, typically an unlabeled dataset.</p></li>
</ul>
</li>
<li><p>Reinforcement learning (<a class="reference external" href="https://deepmind.com/research/case-studies/alphago-the-story-so-far">AlphaGo</a>)</p>
<ul>
<li><p>A family of algorithms for finding suitable actions to take in a given situation in order to maximize a reward.</p></li>
</ul>
</li>
<li><p><strong>Recommendation systems</strong> (<a class="reference external" href="https://www.cs.umd.edu/~samir/498/Amazon-Recommendations.pdf">Amazon item recommendation system</a>)</p>
<ul>
<li><p>Predict the “rating” or “preference” a user would give to an item.</p></li>
</ul>
</li>
</ul>
<p>To contrast the two, we have:</p>
<ul class="simple">
<li><p><strong>Supervised learning</strong></p>
<ul>
<li><p>Training data comprises a set of observations (<span class="math notranslate nohighlight">\(X\)</span>) and their corresponding targets (<span class="math notranslate nohighlight">\(y\)</span>).</p></li>
<li><p>We wish to find a model function <span class="math notranslate nohighlight">\(f\)</span> that relates <span class="math notranslate nohighlight">\(X\)</span> to <span class="math notranslate nohighlight">\(y\)</span>.</p></li>
<li><p>Then use that model function to predict the targets of new examples.</p></li>
<li><p>We have been working with this set up so far.</p></li>
</ul>
</li>
<li><p><strong>Unsupervised learning</strong></p>
<ul>
<li><p>Training data consists of observations (<span class="math notranslate nohighlight">\(X\)</span>) without any corresponding targets.</p></li>
<li><p>Unsupervised learning could be used to group similar things together in <span class="math notranslate nohighlight">\(X\)</span> or to find underlying structure in the data.</p></li>
</ul>
</li>
</ul>
</section>
<section id="can-we-learn-without-targets">
<h3>Can we learn without targets?<a class="headerlink" href="#can-we-learn-without-targets" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Yes, but the learning will be focused on finding the underlying structures of the inputs themselves (rather than finding the function <span class="math notranslate nohighlight">\(f\)</span> between input and output like we did in supervised learning models).</p></li>
<li><p>Examples:</p>
<ul>
<li><p>Clustering (this module)</p></li>
<li><p>Dimensionality reduction (requires some math, not covered here)</p></li>
<li><p>Anomaly detection (we will look into some examples in the upcoming module)</p></li>
</ul>
</li>
</ul>
</section>
<section id="labeled-vs-unlabeled-data">
<h3>Labeled vs. Unlabeled data<a class="headerlink" href="#labeled-vs-unlabeled-data" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>If you have access to labeled training data, you’re in the “supervised” setting.</p></li>
<li><p>You know what to do in that case from the previous lectures</p></li>
<li><p>Unfortunately, getting large amount of labeled training data is often time consuming and expensive.</p></li>
<li><p>Annotated data can become “stale” after a while in cases such as fraud detection.</p></li>
<li><p>Can you still make sense of the data even though you do not have the labels?</p></li>
<li><p>Yes! At least to a certain extent!</p></li>
</ul>
</section>
<section id="example-supervised-vs-unsupervised-learning">
<h3>Example: Supervised vs unsupervised learning<a class="headerlink" href="#example-supervised-vs-unsupervised-learning" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>In supervised learning, we are given features <span class="math notranslate nohighlight">\(X\)</span> and target <span class="math notranslate nohighlight">\(y\)</span>.</p></li>
</ul>
<table>
<tr style="background-color:white;">
    <td>
        <table>
            <tr>
                <td colspan="2" style="text-align:center;"> <b>Dataset 1</b> </td>
                <td></td>
            </tr>
            <tr>
                <td>x<sub>1</sub></td>
                <td>y</td>
            </tr>
            <tr>
                <td> 101.0
                <td> Sick
            </tr>
            <tr>
                <td> 98.5 
                <td> Not Sick
            </tr>
            <tr>
                <td> 93.8 
                <td> Sick
            </tr>
            <tr>
                <td> 104.3
                <td> Sick
            </tr>
            <tr>
                <td> 98.6 
                <td> Not Sick
            </tr>
        </table>
    </td>
    <td>
       <table>
            <tr>
                <td colspan="3" style="text-align:center;"> <b>Dataset2</b> </td>
                <td></td>
            </tr>
            <tr>
                <td>x<sub>1</sub></td>
                <td>x<sub>2</sub></td>
                <td>y</td>
            </tr>
            <tr>
                <td> -2.68
                <td> 0.32 
                <td>class 1
            </tr>
            <tr>
                <td> -2.71
                <td> -0.18
                <td> class 1
            </tr>
            <tr>
                <td> 1.28  
                <td> 0.69    
                <td> class 2
            </tr>
            <tr>
                <td> 0.93  
                <td> 0.32   
                <td> class 2
            </tr>
            <tr>
                <td> 1.39
                <td> -0.28 
                <td> class 3
            </tr>
        </table>
    </td>
</tr>
</table><ul class="simple">
<li><p>In unsupervised learning, we are only given features <span class="math notranslate nohighlight">\(X\)</span>.</p></li>
</ul>
<table>
<tr style="background-color:white;">
    <td>
        <table>
            <tr>
                <td colspan="2" style="text-align:center;"> <b>Dataset 1</b> </td>
                <td></td>
            </tr>
            <tr>
                <td>x<sub>1</sub></td>
            </tr>
            <tr>
                <td> 101.0
            </tr>
            <tr>
                <td> 98.5 
            </tr>
            <tr>
                <td> 93.8 
            </tr>
            <tr>
                <td> 104.3
            </tr>
            <tr>
                <td> 98.6 
            </tr>
        </table>
    </td>
    <td>
       <table>
            <tr>
                <td colspan="3" style="text-align:center;"> <b>Dataset 2</b> </td>
                <td></td>
            </tr>
            <tr>
                <td>x<sub>1</sub></td>
                <td>x<sub>2</sub></td>
            </tr>
            <tr>
                <td> -2.68
                <td> 0.32 
            </tr>
            <tr>
                <td> -2.71
                <td> -0.18
            </tr>
            <tr>
                <td> 1.28  
                <td> 0.69    
            </tr>
            <tr>
                <td> 0.93  
                <td> 0.32   
            </tr>
            <tr>
                <td> 1.39
                <td> -0.28 
            </tr>
        </table>
    </td>
</tr>
</table></section>
<section id="what-is-clustering">
<h3>What is clustering?<a class="headerlink" href="#what-is-clustering" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Most of the data out there is unlabeled.</p></li>
<li><p>Getting labeled training data is often difficult, expensive, or simply impossible in some cases.</p></li>
<li><p>Can we extract some useful information from unlabeled data?</p></li>
<li><p>The most intuitive way is to group similar examples together to get some insight into the data even though we do not have the targets.</p></li>
</ul>
<p><strong>Clustering</strong> is the task of partitioning the dataset into groups called clusters based on their similarities.</p>
<p>The goal of clustering is to discover underlying groups in a given dataset such that:</p>
<ul class="simple">
<li><p>examples in the same group are as similar as possible;</p></li>
<li><p>examples in different groups are as different as possible.</p></li>
</ul>
</section>
<section id="clustering-input-and-possible-output">
<h3>Clustering: Input and (possible) output<a class="headerlink" href="#clustering-input-and-possible-output" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">mglearn</span><span class="o">.</span><span class="n">discrete_scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">mglearn</span><span class="o">.</span><span class="n">discrete_scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/491e4af2d038489cf80d857913d9bea9f55a3b3f58ceb7f5705e0ae96a541223.png" src="../_images/491e4af2d038489cf80d857913d9bea9f55a3b3f58ceb7f5705e0ae96a541223.png" />
</div>
</div>
<ul class="simple">
<li><p>Usually the clusters are identified by a <strong>cluster label</strong>.</p></li>
<li><p>These labels are arbitrary, and relabeling the points (label switching) does not make a difference.</p></li>
<li><p>What we care about is which points have the same labels and which ones have different labels.</p></li>
<li><p>Very often we do not know how many clusters are there in the data or if there are any clusters at all. In real-world data, clusters are rarely as clear as in our toy example above.</p></li>
<li><p>There is a notion of coherent and semantically meaningful clusters in some sense but there is no absolute truth here.</p></li>
</ul>
<section id="example-1-what-is-correct-grouping">
<h4>Example 1: What is “correct” grouping?<a class="headerlink" href="#example-1-what-is-correct-grouping" title="Link to this heading">#</a></h4>
<p>Which of the following grouping of emoticons is the “correct” grouping?</p>
<ul class="simple">
<li><p>In clustering, meaningful groups are dependent on the <strong>application</strong>.</p></li>
<li><p>It usually helps if we have some prior knowledge about the data and the problem.</p></li>
<li><p>This makes it hard for us to objectively measure the quality of a clustering algorithm (or think about “true” clusters).</p></li>
</ul>
</section>
</section>
<section id="common-applications">
<h3>Common applications<a class="headerlink" href="#common-applications" title="Link to this heading">#</a></h3>
<section id="data-exploration">
<h4>Data exploration<a class="headerlink" href="#data-exploration" title="Link to this heading">#</a></h4>
<p>Although there is no notion of the “right” answer, we might still get something useful out of clustering. There are a number of common applications for clustering.</p>
<ul class="simple">
<li><p>Summarize or compress data.</p></li>
<li><p>Partition the data into groups before further processing.</p></li>
<li><p>For instance, you could use it in supervised learning setting as follows. Carry out clustering and examine performance of your model on individual clusters. If the performance is lower on a particular cluster, you could either try building a separate model for that cluster and improve the overall performance of your supervised model.</p></li>
</ul>
</section>
</section>
</section>
<section id="k-means-clustering">
<h2>K-Means clustering<a class="headerlink" href="#k-means-clustering" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Clustering is based on the notion of similarity or distances between points.</p></li>
<li><p>How do we determine similarity between points in a multi-dimensional space?</p></li>
<li><p>Can we use something like <span class="math notranslate nohighlight">\(k\)</span>-neighbours for similarity?</p>
<ul>
<li><p>Yes! That’s a good start!</p></li>
<li><p>With <span class="math notranslate nohighlight">\(k\)</span>-neighbours we used Euclidean distances to find nearby points.</p></li>
<li><p>We can use the same idea for clustering!</p></li>
</ul>
</li>
</ul>
<p>K-Means is one of the most commonly used clustering algorithms.</p>
<p><strong>Input</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">X</span></code> <span class="math notranslate nohighlight">\(\rightarrow\)</span> a set of data points</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">K</span></code> (or <span class="math notranslate nohighlight">\(k\)</span> or <code class="docutils literal notranslate"><span class="pre">n_clusters</span></code>) <span class="math notranslate nohighlight">\(\rightarrow\)</span> number of clusters</p></li>
</ul>
<p><strong>Output</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">K</span></code> clusters (groups) of the data points</p></li>
</ul>
<section id="k-means-using-sklearn">
<h3>K-Means using <code class="docutils literal notranslate"><span class="pre">sklearn</span></code><a class="headerlink" href="#k-means-using-sklearn" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">mglearn</span><span class="o">.</span><span class="n">discrete_scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b9ec6091c204d800eb86575318f39a996c1855e9bab80c3cc50704d16381afc9.png" src="../_images/b9ec6091c204d800eb86575318f39a996c1855e9bab80c3cc50704d16381afc9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>

<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
<span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">);</span>  <span class="c1"># We are only passing X because this is unsupervised learning</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clust_labels</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">clust_labels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2, 1, 0, 1, 2, 2, 0, 0, 1, 2], dtype=int32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2, 1, 0, 1, 2, 2, 0, 0, 1, 2], dtype=int32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cluster_centers</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span>
<span class="n">cluster_centers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.10556679, -5.65013704],
       [ 2.04861878,  5.51226051],
       [ 5.75745416, -9.48073598]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">km_labels</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span>
<span class="n">mglearn</span><span class="o">.</span><span class="n">discrete_scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">mglearn</span><span class="o">.</span><span class="n">discrete_scatter</span><span class="p">(</span>
    <span class="n">cluster_centers</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">cluster_centers</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;*&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f922d503760&gt;,
 &lt;matplotlib.lines.Line2D at 0x7f922d503190&gt;,
 &lt;matplotlib.lines.Line2D at 0x7f922d503f10&gt;]
</pre></div>
</div>
<img alt="../_images/269256e84ed9365c5d41cf090eba4f0eff4ff8de845f26dddadcd5aea3d1f602.png" src="../_images/269256e84ed9365c5d41cf090eba4f0eff4ff8de845f26dddadcd5aea3d1f602.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_examples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="n">kmeans</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">new_examples</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mglearn</span><span class="o">.</span><span class="n">discrete_scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">mglearn</span><span class="o">.</span><span class="n">discrete_scatter</span><span class="p">(</span>
    <span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mglearn</span><span class="o">.</span><span class="n">discrete_scatter</span><span class="p">(</span>
    <span class="n">new_examples</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">new_examples</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">kmeans</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">new_examples</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
    <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e73bc9c6552867783d63be9d76ef7889cf64a1e82411ad18bf91e1beabce5da3.png" src="../_images/e73bc9c6552867783d63be9d76ef7889cf64a1e82411ad18bf91e1beabce5da3.png" />
</div>
</div>
</section>
<section id="k-means-algorithm-main-idea">
<h3>K-Means algorithm: Main idea<a class="headerlink" href="#k-means-algorithm-main-idea" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Represent each cluster by its cluster center and assign a cluster membership to each data point.</p></li>
</ul>
<p><strong>Chicken-and-egg problem!</strong></p>
<ul class="simple">
<li><p>If we knew cluster centers, we can simply assign each point to its nearest center.</p></li>
<li><p>Similarly, if we knew assignments, we can calculate cluster centers.</p></li>
<li><p>But we do not know either 😟.</p></li>
</ul>
<p>A usual computer science answer to such problems is iterations!!</p>
</section>
<section id="k-means-clustering-algorithm">
<h3>K-Means clustering algorithm<a class="headerlink" href="#k-means-clustering-algorithm" title="Link to this heading">#</a></h3>
<p><strong>Input</strong>: Data points X and the number of clusters K</p>
<p><strong>Initialization</strong>: K initial centers for the clusters</p>
<p><strong>Iterative process</strong>:</p>
<p>repeat</p>
<ul class="simple">
<li><p>Assign each example to the closest center.</p></li>
<li><p>Estimate new centers as <em>average</em> of observations in a cluster.</p></li>
</ul>
<p>until <strong>centers stop changing</strong> or <strong>maximum iterations have reached</strong>.</p>
</section>
<section id="initialization">
<h3>Initialization<a class="headerlink" href="#initialization" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Random initialization for K initial centers of the clusters.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_examples</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">centers_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_examples</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
<span class="n">centers</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">centers_idx</span><span class="p">]</span>
<span class="n">plot_km_initialization</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8e37e434ee9360aed6095d990a09143427a1dda1f1743d4f46590bf2bf9e8cd2.png" src="../_images/8e37e434ee9360aed6095d990a09143427a1dda1f1743d4f46590bf2bf9e8cd2.png" />
</div>
</div>
</section>
<section id="iterative-process">
<h3>Iterative process<a class="headerlink" href="#iterative-process" title="Link to this heading">#</a></h3>
<section id="how-to-find-closest-centers">
<h4>How to find closest centers?<a class="headerlink" href="#how-to-find-closest-centers" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>First step in the iterative process is assigning examples to the closest center.</p></li>
<li><p>Let’s consider distance of an example to all centers and assign that example to the closest center.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plot_example_dist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">point_ind</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/052a4a8256e307ff35fc66cd57454ffba2c432907a366fdd040522863e3a11b4.png" src="../_images/052a4a8256e307ff35fc66cd57454ffba2c432907a366fdd040522863e3a11b4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">update_Z</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="n">new_centers</span> <span class="o">=</span> <span class="n">update_centers</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plot_km_iteration</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">new_centers</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4cc55735b57d0ae1765370b6cc7e625477f409cd9336605b5667fb5179c7a663.png" src="../_images/4cc55735b57d0ae1765370b6cc7e625477f409cd9336605b5667fb5179c7a663.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">update_Z</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="n">new_centers</span> <span class="o">=</span> <span class="n">update_centers</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plot_km_iteration</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">new_centers</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/aa6440ed25591b29937cdbce0615326bcd4bf001d6bf2b250fe2ebda8adeef99.png" src="../_images/aa6440ed25591b29937cdbce0615326bcd4bf001d6bf2b250fe2ebda8adeef99.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">update_Z</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
<span class="n">new_centers</span> <span class="o">=</span> <span class="n">update_centers</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plot_km_iteration</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">new_centers</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f389d729f24fd6ba58a0175504ecd59eedd05a56aa5ba7b7f194c5a270b9cf18.png" src="../_images/f389d729f24fd6ba58a0175504ecd59eedd05a56aa5ba7b7f194c5a270b9cf18.png" />
</div>
</div>
</section>
</section>
<section id="when-to-stop">
<h3>When to stop?<a class="headerlink" href="#when-to-stop" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Seems like after iteration 4 our centroids aren’t changing anymore.</p></li>
<li><p>The algorithm has converged. So we stop!</p></li>
<li><p>K-Means always converges. It doesn’t mean it finds the “right” clusters. It can converge to a sub-optimal solution.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_km_iterative</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="n">centers_idx</span><span class="p">],</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e9258028eb31151265b18671c7837c807b0c073f1a73291ce4d9d152e5ff9ac5.png" src="../_images/e9258028eb31151265b18671c7837c807b0c073f1a73291ce4d9d152e5ff9ac5.png" />
</div>
</div>
</section>
<section id="a-comment-on-initialization">
<h3>A comment on initialization<a class="headerlink" href="#a-comment-on-initialization" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The initialization of K-Means is stochastic, can this affect the results?</p>
<ul>
<li><p>Yes! Big time.</p></li>
</ul>
</li>
<li><p>Let’s look at an example.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_init</span><span class="p">,</span> <span class="n">y_init</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">discrete_scatter</span><span class="p">(</span><span class="n">X_init</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_init</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/cae59f4b948fe22dc566c3565e3166b3a6a4283b2c3b59c8d49923c74a33dacf.png" src="../_images/cae59f4b948fe22dc566c3565e3166b3a6a4283b2c3b59c8d49923c74a33dacf.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n_examples</span> <span class="o">=</span> <span class="n">X_init</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-bad-initialization">
<h3>Example: Bad initialization<a class="headerlink" href="#example-bad-initialization" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">centroids_idx_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_examples</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
<span class="n">plot_km_iterative</span><span class="p">(</span><span class="n">X_init</span><span class="p">,</span> <span class="n">X_init</span><span class="p">[</span><span class="n">centroids_idx_init</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/383078b9b2a98d337fd68cc3757af7c26dd1d936b42049a0cfae71c8a100fa25.png" src="../_images/383078b9b2a98d337fd68cc3757af7c26dd1d936b42049a0cfae71c8a100fa25.png" />
</div>
</div>
</section>
<section id="example-better-initialization">
<h3>Example: Better initialization<a class="headerlink" href="#example-better-initialization" title="Link to this heading">#</a></h3>
<p>The following initialization seems much better.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">centroids_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_examples</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
<span class="n">plot_km_iterative</span><span class="p">(</span><span class="n">X_init</span><span class="p">,</span> <span class="n">X_init</span><span class="p">[</span><span class="n">centroids_idx</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5dd0a48e3145ad0ecb689f804a5f39b4737f8a79bf655d2d468ed9ad1159d9de.png" src="../_images/5dd0a48e3145ad0ecb689f804a5f39b4737f8a79bf655d2d468ed9ad1159d9de.png" />
</div>
</div>
</section>
<section id="what-can-we-do-about-it">
<h3>What can we do about it?<a class="headerlink" href="#what-can-we-do-about-it" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>One strategy is to run the algorithm several times.</p>
<ul>
<li><p>Check out <code class="docutils literal notranslate"><span class="pre">n_init</span></code> parameter of <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html"><code class="docutils literal notranslate"><span class="pre">sklearn</span></code>’s <code class="docutils literal notranslate"><span class="pre">KMeans</span></code></a>.</p></li>
</ul>
</li>
<li><p>Is it possible to pick <code class="docutils literal notranslate"><span class="pre">K</span></code> in a smart way?</p>
<ul>
<li><p>Yes! We can use the so-called <a class="reference external" href="http://ilpubs.stanford.edu:8090/778/1/2006-13.pdf">K-Means++</a>.</p></li>
<li><p>Intuitively, it picks the initial centroids which are far away from each other.</p></li>
<li><p>In other words, K-Means++ gives more chance to select points that are far away from centroids already picked.</p></li>
<li><p>By default <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> uses this strategy for initialization.</p></li>
</ul>
</li>
</ul>
</section>
<section id="hyperparameter-tuning-for-the-number-of-clusters">
<h3>Hyperparameter tuning for the number of clusters<a class="headerlink" href="#hyperparameter-tuning-for-the-number-of-clusters" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>When running K-Means we need to decide the number of clusters in advance (<code class="docutils literal notranslate"><span class="pre">n_clusters</span></code> in <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>). How do we pick this hyperparameter?</p></li>
<li><p>In supervised setting we carried out hyperparameter optimization based on cross-validation scores.</p></li>
<li><p>Since in unsupervised learning we do not have the target values, it becomes difficult to objectively measure the effectiveness of the algorithms.</p></li>
<li><p>There is no definitive or satisfactory approach.</p></li>
<li><p>However, some strategies might be useful to help you determine K.</p></li>
</ul>
</section>
<section id="method-1-the-elbow-method">
<h3>Method 1: The Elbow method<a class="headerlink" href="#method-1-the-elbow-method" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>This method looks at the sum of <strong>intra-cluster distances</strong>, which is also referred to as <strong>inertia</strong>.</p></li>
<li><p>The intra-cluster distance in our toy example above is given as</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\sum_{P_i \in C_1}  distance(P_i, C_1)^2 + \sum_{P_i \in C_2}  distance(P_i, C_2)^2 + \sum_{P_i \in C_3} distance(P_i, C_3)^2\]</div>
<p>Where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(C_1, C_2, C_3\)</span> are centroids</p></li>
<li><p><span class="math notranslate nohighlight">\(P_i\)</span>s are points within that cluster</p></li>
<li><p><span class="math notranslate nohighlight">\(distance\)</span> is the usual Euclidean distance.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XX</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">centers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">discrete_scatter</span><span class="p">(</span><span class="n">XX</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">XX</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a904fe086c8cd02c8e303f3a4d9256112ec759e35a5e178a5d97405b131ef8ce.png" src="../_images/a904fe086c8cd02c8e303f3a4d9256112ec759e35a5e178a5d97405b131ef8ce.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;K&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;inertia&quot;</span><span class="p">:</span> <span class="p">[]}</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XX</span><span class="p">)</span>
    <span class="n">d</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">d</span><span class="p">[</span><span class="s2">&quot;inertia&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">inertia_</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>K</th>
      <th>inertia</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>4372.460950</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11</td>
      <td>70.076284</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21</td>
      <td>26.137410</td>
    </tr>
    <tr>
      <th>3</th>
      <td>31</td>
      <td>15.359887</td>
    </tr>
    <tr>
      <th>4</th>
      <td>41</td>
      <td>6.844921</td>
    </tr>
    <tr>
      <th>5</th>
      <td>51</td>
      <td>3.593508</td>
    </tr>
    <tr>
      <th>6</th>
      <td>61</td>
      <td>2.126488</td>
    </tr>
    <tr>
      <th>7</th>
      <td>71</td>
      <td>1.016676</td>
    </tr>
    <tr>
      <th>8</th>
      <td>81</td>
      <td>0.385639</td>
    </tr>
    <tr>
      <th>9</th>
      <td>91</td>
      <td>0.053156</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>The inertia decreases as K increases.</p></li>
<li><p>Question: Do we want inertia to be small or large?</p></li>
<li><p>The problem is that we can’t just look for a <span class="math notranslate nohighlight">\(k\)</span> that minimizes inertia because it decreases as <span class="math notranslate nohighlight">\(k\)</span> increases.</p>
<ul>
<li><p>If I have number of clusters = number of examples, each example will have its own cluster and the intra-cluster distance will be 0.</p></li>
</ul>
</li>
<li><p>Instead we evaluate the trade-off: “small k” vs “small intra-cluster distances”.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_elbow</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">inertia_values</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-.&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">inertia_values</span><span class="p">,</span> <span class="s2">&quot;-o&quot;</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">h</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">w</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Inertia&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">w</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inertia_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
    <span class="n">inertia_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XX</span><span class="p">)</span><span class="o">.</span><span class="n">inertia_</span><span class="p">)</span>
<span class="n">plot_elbow</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">inertia_values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/00fa2c8b75c7332d379aaf284069086937ceb74166d3d57b856af2ff5a2dfe8b.png" src="../_images/00fa2c8b75c7332d379aaf284069086937ceb74166d3d57b856af2ff5a2dfe8b.png" />
</div>
</div>
<ul class="simple">
<li><p>From the above plot, we could argue that three clusters (the point of inflection on the curve) are enough.</p></li>
<li><p>The inertia decreases when clusters are greater than 3. However it’s not a big improvement and so we prefer K=3.</p></li>
<li><p>In this toy example, it’s the plot is kind of clear and easy to interpret but it can be hard to interpret in real life examples.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">yellowbrick.cluster</span> <span class="kn">import</span> <span class="n">KElbowVisualizer</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_init</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">KElbowVisualizer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">visualizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XX</span><span class="p">)</span>  <span class="c1"># Fit the data to the visualizer</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/cea5279bb21e4fe7f1d84762ec59c9f3ddb110d66144130a04a4d3a359ca698c.png" src="../_images/cea5279bb21e4fe7f1d84762ec59c9f3ddb110d66144130a04a4d3a359ca698c.png" />
</div>
</div>
</section>
<section id="method-2-the-silhouette-method">
<h3>Method 2: The Silhouette method<a class="headerlink" href="#method-2-the-silhouette-method" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Not dependent on the notion of cluster centers.</p></li>
<li><p>Calculated using the <strong>mean intra-cluster distance</strong> (<span class="math notranslate nohighlight">\(a\)</span>) and the <strong>mean nearest-cluster distance</strong> (<span class="math notranslate nohighlight">\(b\)</span>) for each sample.</p></li>
</ul>
</section>
<section id="mean-intra-cluster-distance-a">
<h3>Mean intra-cluster distance (<span class="math notranslate nohighlight">\(a\)</span>)<a class="headerlink" href="#mean-intra-cluster-distance-a" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Suppose the green point below is our sample.</p></li>
<li><p>Average of the distances of the green point to the other points in the same cluster.</p>
<ul>
<li><p>These distances are represented by the black lines.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_silhouette_dist</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/672dbcf9f2c135c00341c9a1fbdf902a22921b78b2fa7d0397be3930fc2baac0.png" src="../_images/672dbcf9f2c135c00341c9a1fbdf902a22921b78b2fa7d0397be3930fc2baac0.png" />
</div>
</div>
</section>
<section id="mean-nearest-cluster-distance-b">
<h3>Mean nearest-cluster distance (<span class="math notranslate nohighlight">\(b\)</span>)<a class="headerlink" href="#mean-nearest-cluster-distance-b" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Average of the distances of the green point to the blue points is smaller than the average of the distances of the green point to the red points. So the <strong>nearest cluster</strong> is the blue cluster.</p></li>
<li><p>So the mean nearest-cluster distance is the average of the distances of the green point to the blue points.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_silhouette_dist</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/672dbcf9f2c135c00341c9a1fbdf902a22921b78b2fa7d0397be3930fc2baac0.png" src="../_images/672dbcf9f2c135c00341c9a1fbdf902a22921b78b2fa7d0397be3930fc2baac0.png" />
</div>
</div>
</section>
<section id="silhouette-distance-for-a-sample">
<h3>Silhouette distance for a sample<a class="headerlink" href="#silhouette-distance-for-a-sample" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>the difference between the <strong>the average nearest-cluster distance</strong> (<span class="math notranslate nohighlight">\(b\)</span>) and <strong>average intra-cluster distance</strong> (<span class="math notranslate nohighlight">\(a\)</span>) for each sample, normalized by the maximum value</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\frac{b-a}{max(a,b)}\]</div>
<ul class="simple">
<li><p>The best value is 1.</p></li>
<li><p>The worst value is -1 (samples have been assigned to wrong clusters).</p></li>
<li><p>Value near 0 means overlapping clusters.</p></li>
</ul>
<p>The overall <strong>Silhouette score</strong> is the average of the Silhouette scores for all samples. We can visualize the silhouette score for each example individually in a silhouette plot (hence the name), see below.</p>
</section>
<section id="using-silhouette-scores-to-select-the-number-of-clusters">
<h3>Using Silhouette scores to select the number of clusters<a class="headerlink" href="#using-silhouette-scores-to-select-the-number-of-clusters" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The following plots show the Silhouette scores for each sample in that cluster.</p></li>
<li><p>Higher values indicate well-separated clusters.</p></li>
<li><p>The size of the Silhouette shows the number of samples and hence shows imbalance of data points in clusters.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">yellowbrick.cluster</span> <span class="kn">import</span> <span class="n">SilhouetteVisualizer</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">SilhouetteVisualizer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;yellowbrick&quot;</span><span class="p">)</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XX</span><span class="p">)</span>  <span class="c1"># Fit the data to the visualizer</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>  <span class="c1"># Finalize and render the figure</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9679eab39cd9235b53e9abcd6507e1716e5051e2164429d899f3388019dd88c4.png" src="../_images/9679eab39cd9235b53e9abcd6507e1716e5051e2164429d899f3388019dd88c4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">SilhouetteVisualizer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;yellowbrick&quot;</span><span class="p">)</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XX</span><span class="p">)</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f723001dcfc521e2983b60a350f178f757125c98e4b955ab94fa7dc12bc812c5.png" src="../_images/f723001dcfc521e2983b60a350f178f757125c98e4b955ab94fa7dc12bc812c5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">SilhouetteVisualizer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;yellowbrick&quot;</span><span class="p">)</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XX</span><span class="p">)</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/21fff8e7d07b564e32d9995f0c4906d89b8a7f28b1c3fcfd9767db7a611fa39e.png" src="../_images/21fff8e7d07b564e32d9995f0c4906d89b8a7f28b1c3fcfd9767db7a611fa39e.png" />
</div>
</div>
</section>
<section id="what-to-look-for-in-these-plots">
<h3>What to look for in these plots?<a class="headerlink" href="#what-to-look-for-in-these-plots" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Unlike inertia, larger values are better because they indicate that the point is further away from neighbouring clusters.</p></li>
<li><p>The thickness of each silhouette indicates the cluster size.</p></li>
<li><p>The shape of each silhouette indicates the “goodness” for points in each cluster.</p></li>
<li><p>The length (or area) of each silhouette indicates the goodness of each cluster.</p></li>
<li><p>A slower dropoff (more rectangular) indicates more points are “happy” in their cluster.</p></li>
<li><p>We can apply Silhouette method to clustering methods other than K-Means.</p></li>
</ul>
</section>
<section id="final-comments-summary-and-reflection">
<h3>Final comments, summary, and reflection<a class="headerlink" href="#final-comments-summary-and-reflection" title="Link to this heading">#</a></h3>
</section>
<section id="important-points-to-remember">
<h3>Important points to remember<a class="headerlink" href="#important-points-to-remember" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Clustering is a common unsupervised approach to identify underlying structure in data and grouping points based on similarity.</p></li>
<li><p>Appropriate data representation is crucial for meaningful clustering.</p></li>
<li><p>We did not talk much about distance metrics but that is another importance consideration in clustering.</p></li>
<li><p>K-Means is a popular clustering algorithm.</p></li>
</ul>
<p><strong>Clustering with K-Means</strong></p>
<ul class="simple">
<li><p>It requires us to specify the number of clusters in advance.</p></li>
<li><p>Each example is assigned to one (and only one) cluster.</p></li>
<li><p>The labels provided by the algorithm have no actual meaning.</p></li>
<li><p>The centroids live in the same space as of the dataset but they are <strong>not</strong> actual data points, but instead are average points.</p></li>
<li><p>It always converges. Convergence is dependent upon the initial centers and it may converge to a sub-optimal solution.</p></li>
<li><p>Two popular ways to provide insight into how many clusters are reasonable for the give problem are: <strong>the Elbow method</strong> and <strong>the Silhouette method</strong>.</p></li>
</ul>
</section>
</section>
<section id="let-s-look-at-a-different-clustering-method">
<h2>Let’s look at a different Clustering method!<a class="headerlink" href="#let-s-look-at-a-different-clustering-method" title="Link to this heading">#</a></h2>
<section id="introduction-to-gaussian-mixture-models-high-level">
<h3>Introduction to Gaussian mixture models (high-level)<a class="headerlink" href="#introduction-to-gaussian-mixture-models-high-level" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>K-Means is great but it cannot handle oddly shaped clusters.</p></li>
<li><p>In K-Means our clusters are solely defined by cluster centers.</p></li>
<li><p>Let’s look at a toy example. We will generate a sample cluster with multivariate normal distribution</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">multivariate_normal</span><span class="p">,</span> <span class="n">norm</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_blobs</span><span class="p">,</span> <span class="n">make_circles</span><span class="p">,</span> <span class="n">make_moons</span>

<span class="n">dataset_sub1</span> <span class="o">=</span> <span class="n">multivariate_normal</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span>
    <span class="n">mean</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">cov</span><span class="o">=</span><span class="p">[[</span><span class="mi">12</span><span class="p">,</span> <span class="mf">11.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">11.5</span><span class="p">,</span> <span class="mi">12</span><span class="p">]],</span> <span class="n">size</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="n">dataset_sub2</span> <span class="o">=</span> <span class="n">multivariate_normal</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span>
    <span class="n">mean</span><span class="o">=</span><span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">cov</span><span class="o">=</span><span class="p">[[</span><span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">]],</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="n">dataset_sub3</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cluster_std</span><span class="o">=</span><span class="mf">1.8</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">dataset_sub4</span> <span class="o">=</span> <span class="n">dataset_sub3</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="p">])</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">dataset_sub1</span><span class="p">,</span> <span class="n">dataset_sub2</span><span class="p">,</span> <span class="n">dataset_sub4</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">discrete_scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">6</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d9d731e4de6e2c94b134648eda4dfa885872f27d2401b9e17f1136f49603b3bb.png" src="../_images/d9d731e4de6e2c94b134648eda4dfa885872f27d2401b9e17f1136f49603b3bb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">km</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
<span class="n">km</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">km_labels</span> <span class="o">=</span> <span class="n">km</span><span class="o">.</span><span class="n">labels_</span>
<span class="n">plot_kmeans_circles</span><span class="p">(</span><span class="n">km</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e8e90a69bfa52fe85c786978a1ddbd82e15c6555cb4bdbb6c81f954ed658fc31.png" src="../_images/e8e90a69bfa52fe85c786978a1ddbd82e15c6555cb4bdbb6c81f954ed658fc31.png" />
</div>
</div>
<ul class="simple">
<li><p>K-Means is not doing a good job.</p></li>
<li><p>One limitation of K-Means is that it only takes into account means of data points and not the spread of the data points.</p></li>
<li><p>How about taking into account the covariance matrices, i.e., how spread out the data is?</p></li>
<li><p>Is it possible to generalize K-Means clustering to incorporate information about the covariance structure of the data as well as the centers?</p></li>
<li><p>One idea is to model the data as a weighted sum of Gaussian distributions, where each Gausssian, referred to as a <strong>component</strong> of the mixture, has its own mean vector and covariance matrix and a corresponding weight. These models are referred to as <strong>mixture of Gaussians</strong> or <strong>Gaussian mixture models</strong>.</p></li>
<li><p>There is a lot to say about these models. In the interest of time, we’ll keep things high level in this course.</p></li>
<li><p>First, let’s try it out with sklearn.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.mixture</span> <span class="kn">import</span> <span class="n">GaussianMixture</span>

<span class="n">gmm</span> <span class="o">=</span> <span class="n">GaussianMixture</span><span class="p">(</span>
    <span class="n">n_components</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">covariance_type</span><span class="o">=</span><span class="s2">&quot;full&quot;</span>
<span class="p">)</span>  <span class="c1"># more on covariance_type in a bit</span>
<span class="n">gmm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">gmm_labels</span> <span class="o">=</span> <span class="n">gmm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">discrete_scatter</span><span class="p">(</span>
    <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">km_labels</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">gmm_labels</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;KMeans clustering&quot;</span><span class="p">)</span>
<span class="n">discrete_scatter</span><span class="p">(</span>
    <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">gmm_labels</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">gmm_labels</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Clustering with Gaussian mixture model&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/333b46b898e4709af2817f7e3de486ca2a94db1427954e411e596098fd4752e4.png" src="../_images/333b46b898e4709af2817f7e3de486ca2a94db1427954e411e596098fd4752e4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gmm</span><span class="o">.</span><span class="n">means_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.25596947, -5.15011412],
       [11.38137298, -3.31731115],
       [ 1.93609356,  3.96311554]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gmm</span><span class="o">.</span><span class="n">covariances_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[ 1.97803583,  0.26628563],
        [ 0.26628563,  3.11174164]],

       [[ 9.09449493, -7.25892116],
        [-7.25892116,  9.394036  ]],

       [[10.95673803, 10.63462235],
        [10.63462235, 11.26072047]]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gmm</span><span class="o">.</span><span class="n">weights_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.14042383, 0.28682168, 0.57275449])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">gmm</span><span class="o">.</span><span class="n">weights_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<section id="how-does-it-work-high-level">
<h4>How does it work? (high-level)<a class="headerlink" href="#how-does-it-work-high-level" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Given <span class="math notranslate nohighlight">\(k\)</span>, the number of clusters or the number of components, we want to fit Gaussian blobs to the data. Each Gaussian will have it’s own mean vector and covariance matrix.</p></li>
<li><p>This is a <strong>generative model</strong>; it models the probability of a given data point being generated from the mixture of the Gaussians.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[P(x) = \sum_{j=1}^{k} \pi_k \mathcal{N}(x, \mu_k, \Sigma_k)\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x \rightarrow\)</span> a data point</p></li>
<li><p><span class="math notranslate nohighlight">\(\pi_k \rightarrow\)</span> the weight of component <span class="math notranslate nohighlight">\(k\)</span> (between 0 to 1)</p></li>
<li><p><span class="math notranslate nohighlight">\(k \rightarrow\)</span> the number of clusters or the number of components</p></li>
<li><p><span class="math notranslate nohighlight">\(\mu_k \rightarrow\)</span> the mean vector of component <span class="math notranslate nohighlight">\(k\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\Sigma_k \rightarrow\)</span> the covariance matrix associated with component <span class="math notranslate nohighlight">\(k\)</span></p></li>
</ul>
<p>The generative story of the model assumes that each data point in the dataset is generated from one of the Gaussian components. So for each example <span class="math notranslate nohighlight">\(x\)</span>:</p>
<ul class="simple">
<li><p>Choose component <span class="math notranslate nohighlight">\(k\)</span> with probabilities proportional to the weight <span class="math notranslate nohighlight">\(\pi_k\)</span> (prior probability) of the components.</p></li>
<li><p>Choose example <span class="math notranslate nohighlight">\(x\)</span> from the Gaussian distribution associated with the <span class="math notranslate nohighlight">\(k^{th}\)</span> component: <span class="math notranslate nohighlight">\(\mathcal{N}(x, \mu_k, \Sigma_k)\)</span></p></li>
</ul>
<p>A mixture of Gaussians can model much more complicated shapes than a single Gaussian distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">Gaussian_mixture_1d</span><span class="p">(</span><span class="n">ϕ1</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ϕ2</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d3c406ca7de017d27b4b3bf0bb76f00c1366d25c0c1b79c22ad61c416bf41ac9.png" src="../_images/d3c406ca7de017d27b4b3bf0bb76f00c1366d25c0c1b79c22ad61c416bf41ac9.png" />
</div>
</div>
<p>The goal is to estimate <span class="math notranslate nohighlight">\(\pi_k\)</span>, <span class="math notranslate nohighlight">\(\mu_k\)</span>, <span class="math notranslate nohighlight">\(\Sigma_k\)</span> for all clusters or components <span class="math notranslate nohighlight">\(k\)</span>.</p>
<ul class="simple">
<li><p>It’s a non-convex optimization problem</p></li>
<li><p>It is sensitive to initialization. Usually, it’s initialized with K-Means.</p></li>
<li><p>Generally used with “soft” assignments. Each point contributes to the mean and covariance of each component but the points that are far away only contribute a little.</p></li>
</ul>
<p>Under the hood it finds these parameters using an algorithm called <strong>Expectation Maximization</strong>. The idea is to treat the clusters as <strong>hidden variables</strong>.</p>
<ul class="simple">
<li><p>Choose starting guesses for the location and shape</p></li>
<li><p>Repeat until converged:</p>
<ul>
<li><p>E-step: for each point, find weights encoding the probability of membership in each cluster</p></li>
<li><p>M-step: for each cluster, update its location, normalization, and shape based on all data points, making use of the weights</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>spherical: each component has its own single variance</p></li>
<li><p>diag: each component has its own diagonal covariance matrix which results in axis-aligned clusters</p></li>
<li><p>tied: all components share the same general covariance matrix which results in Gaussian components with the same shape and orientations</p></li>
<li><p>full: each component has its own general covariance matrix which results in Gaussian components with different shapes and different orientations</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">estimators</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">cov_type</span><span class="p">:</span> <span class="n">GaussianMixture</span><span class="p">(</span>
        <span class="n">n_components</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">covariance_type</span><span class="o">=</span><span class="n">cov_type</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">cov_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;spherical&quot;</span><span class="p">,</span> <span class="s2">&quot;diag&quot;</span><span class="p">,</span> <span class="s2">&quot;tied&quot;</span><span class="p">,</span> <span class="s2">&quot;full&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_gmm_cov_types</span><span class="p">(</span><span class="n">estimators</span><span class="p">,</span> <span class="n">X_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/cf3b4675ddce7e31bf5be2f7fc700602962b648db0d6a42d48e7df8af8caa739.png" src="../_images/cf3b4675ddce7e31bf5be2f7fc700602962b648db0d6a42d48e7df8af8caa739.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">estimators</span><span class="p">[</span><span class="s2">&quot;full&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_train</span><span class="p">)[</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">])</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.9996</td>
      <td>0.0000</td>
      <td>0.0004</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.9899</td>
      <td>0.0101</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.9966</td>
      <td>0.0034</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.9999</td>
      <td>0.0001</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.9961</td>
      <td>0.0039</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.9935</td>
      <td>0.0065</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.9927</td>
      <td>0.0073</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.9981</td>
      <td>0.0000</td>
      <td>0.0019</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.9839</td>
      <td>0.0157</td>
      <td>0.0003</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.0000</td>
      <td>0.0000</td>
      <td>0.0000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Since GMM is a generative model, we can get the log likelihood of the model generating this data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">estimators</span><span class="p">[</span><span class="s2">&quot;full&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-5.073780282241252
</pre></div>
</div>
</div>
</div>
<p>It’s possible to do model selection, i.e., selecting the appropriate covariance type and the number of components based on Akaike Information Criterion (AIC) or Bayesian Information Criterion (BIC) which penalize complex models.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_components</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>

<span class="n">gmm_models</span> <span class="o">=</span> <span class="p">[</span><span class="n">GaussianMixture</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">n_components</span><span class="p">]</span>
<span class="n">aic_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">aic</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">gmm_models</span><span class="p">]</span>
<span class="n">bic_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">bic</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">gmm_models</span><span class="p">]</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">n_components</span><span class="p">,</span> <span class="n">aic_scores</span><span class="p">,</span> <span class="n">bic_scores</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;n_components&quot;</span><span class="p">,</span> <span class="s2">&quot;aic&quot;</span><span class="p">,</span> <span class="s2">&quot;bic&quot;</span><span class="p">])</span>
<span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">bic_scores</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_components</span><span class="p">,</span> <span class="n">bic_scores</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;BIC&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_components</span><span class="p">,</span> <span class="n">aic_scores</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;AIC&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;n_components&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e6c80049dbbd258b0b958a120956de4ea837a3ddd2ad248cd07f668b354c6bbe.png" src="../_images/e6c80049dbbd258b0b958a120956de4ea837a3ddd2ad248cd07f668b354c6bbe.png" />
</div>
</div>
<p><strong>Clustering with Gaussian mixture models</strong></p>
<ul class="simple">
<li><p>Gaussian mixture models model the distribution of data as a mixture of <span class="math notranslate nohighlight">\(k\)</span> Gaussian components.</p></li>
<li><p>Each Gaussian has a different mean vector and co-variance matrix and a weight associated with it, which control its location, shape, and complexity.</p></li>
<li><p>You can control and shape and complexity of the Gaussians by restricting the covariance matrix. There are four common ways to do this in <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>: spherical, diag, tied, full</p></li>
<li><p>Gaussian mixture models are a probabilistic model; they assign a probability to each data point belonging to each cluster. In <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>, we can access these soft assignments using <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> scores.</p></li>
<li><p>The model also gives us the log likelihood of fitting the data. It’s possible to calculate AIC and BIC scores and pick the number of components where these scores are the lowest.</p></li>
</ul>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Module_3_Data_preprocessing_and_features_selection.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Module 3:</strong> Data Preprocessing and Features Selection</p>
      </div>
    </a>
    <a class="right-next"
       href="Module_5_Anomaly_and_Intrusion_Detection_with_Machine_Learning.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>Module 5:</strong> Anomaly and Intrusion Detection with Machine Learning</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-and-segmentation">Clustering and Segmentation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-unsupervised-learning">Introduction to unsupervised learning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#types-of-machine-learning">Types of machine learning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#can-we-learn-without-targets">Can we learn without targets?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#labeled-vs-unlabeled-data">Labeled vs. Unlabeled data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-supervised-vs-unsupervised-learning">Example: Supervised vs unsupervised learning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-clustering">What is clustering?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-input-and-possible-output">Clustering: Input and (possible) output</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-what-is-correct-grouping">Example 1: What is “correct” grouping?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-applications">Common applications</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-exploration">Data exploration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-clustering">K-Means clustering</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-using-sklearn">K-Means using <code class="docutils literal notranslate"><span class="pre">sklearn</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-algorithm-main-idea">K-Means algorithm: Main idea</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-clustering-algorithm">K-Means clustering algorithm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initialization">Initialization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iterative-process">Iterative process</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-find-closest-centers">How to find closest centers?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#when-to-stop">When to stop?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-comment-on-initialization">A comment on initialization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-bad-initialization">Example: Bad initialization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-better-initialization">Example: Better initialization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-can-we-do-about-it">What can we do about it?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hyperparameter-tuning-for-the-number-of-clusters">Hyperparameter tuning for the number of clusters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#method-1-the-elbow-method">Method 1: The Elbow method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#method-2-the-silhouette-method">Method 2: The Silhouette method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-intra-cluster-distance-a">Mean intra-cluster distance (<span class="math notranslate nohighlight">\(a\)</span>)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-nearest-cluster-distance-b">Mean nearest-cluster distance (<span class="math notranslate nohighlight">\(b\)</span>)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#silhouette-distance-for-a-sample">Silhouette distance for a sample</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-silhouette-scores-to-select-the-number-of-clusters">Using Silhouette scores to select the number of clusters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-to-look-for-in-these-plots">What to look for in these plots?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#final-comments-summary-and-reflection">Final comments, summary, and reflection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#important-points-to-remember">Important points to remember</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-look-at-a-different-clustering-method">Let’s look at a different Clustering method!</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-gaussian-mixture-models-high-level">Introduction to Gaussian mixture models (high-level)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-does-it-work-high-level">How does it work? (high-level)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By WSU Staffs
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>