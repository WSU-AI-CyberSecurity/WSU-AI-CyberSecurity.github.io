
<!DOCTYPE html>


<html lang="en" data-content_root="../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Module 3: Data Preprocessing and Features Selection &#8212; WSU ML in Cybersecurity</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=c72df8c4" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=afe5de03"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/Module_3_Data_preprocessing_and_features_selection';</script>
    <script src="../_static/custom.js?v=a4c55d5e"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Module 4: Unsupervised Learning" href="Module_4_Unsupervised_Learning.html" />
    <link rel="prev" title="Module 2: Supervised Learning" href="Module_2_Supervised_learning.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="WSU ML in Cybersecurity - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="WSU ML in Cybersecurity - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Exploring Machine Learning in Cybersecurity Workshop
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Module_0_Introduction_to_Jupyter_Notebook_and_Colab.html"><strong>Module 0:</strong> Introduction to Jupyter Notebook and Colab</a></li>



<li class="toctree-l1"><a class="reference internal" href="Module_1_Fundamentals_of_Machine_Learning.html"><strong>Module 1:</strong> Fundamentals of Machine Learning</a></li>

<li class="toctree-l1"><a class="reference internal" href="Module_2_Supervised_learning.html"><strong>Module 2:</strong> Supervised Learning</a></li>




<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Module 3:</strong> Data Preprocessing and Features Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="Module_4_Unsupervised_Learning.html"><strong>Module 4</strong>: Unsupervised Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Module_5_Anomaly_and_Intrusion_Detection_with_Machine_Learning.html"><strong>Module 5:</strong> Anomaly and Intrusion Detection with Machine Learning</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/WSU-AI-CyberSecurity/WSU-AI-CyberSecurity.github.io/blob/main/notebooks/Module_3_Data_preprocessing_and_features_selection.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/Module_3_Data_preprocessing_and_features_selection.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Module 3: Data Preprocessing and Features Selection</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-objectives">Key Objectives:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-data-preprocessing-matters">Why Data Preprocessing Matters:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualising-scaling-methods">Visualising scaling methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#navigating-the-module">Navigating the Module:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-k-nearest-neighbours-on-the-spotify-dataset">Example: <span class="math notranslate nohighlight">\(k\)</span>-nearest neighbours on the Spotify dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#do-you-see-any-problem">Do you see any problem?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scaling-using-scikit-learn-s-standardscaler">Scaling using <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>’s <code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fit-and-transform-paradigm-for-transformers"><code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">transform</span></code> paradigm for transformers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sklearn-api-summary-estimators"><code class="docutils literal notranslate"><span class="pre">sklearn</span></code> API summary: estimators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-preprocessing-techniques">Common preprocessing techniques</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-splitting-and-baseline">Dataset, splitting, and baseline</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eda">EDA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-all-transformations-we-need-to-apply-on-the-dataset">What all transformations we need to apply on the dataset?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-first-run-our-baseline-model-dummyregressor">Let’s first run our baseline model <code class="docutils literal notranslate"><span class="pre">DummyRegressor</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scaling">Scaling</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-transformations-and-the-golden-rule">Feature transformations and the golden rule</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pipelines">Pipelines</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#alternative-and-more-compact-syntax-make-pipeline">Alternative and more compact syntax: <code class="docutils literal notranslate"><span class="pre">make_pipeline</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-try-cross-validation-with-our-pipeline">Let’s try cross-validation with our pipeline</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#categorical-features">Categorical features</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#can-we-use-this-feature-in-the-model">Can we use this feature in the model?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-are-the-options">What are the options?</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#one-hot-encoding-ohe">One-hot encoding (OHE)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-do-it-on-our-dataset">Let’s do it on our dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-did-we-learn-with-this-module">What did we learn with this module?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-different-transformations-on-different-columns">Problem: Different transformations on different columns</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="module-3-data-preprocessing-and-features-selection">
<h1><strong>Module 3:</strong> Data Preprocessing and Features Selection<a class="headerlink" href="#module-3-data-preprocessing-and-features-selection" title="Link to this heading">#</a></h1>
<p>Welcome to Module 3 of our learning journey! In this segment, we’ll delve into the critical aspects of Data Preprocessing and Feature Selection.</p>
<p>As aspiring data enthusiasts, you’ve likely realized that the journey from raw data to meaningful insights involves careful preparation and strategic selection. This module is designed to equip you with the essential skills to transform raw, messy data into a refined and feature-rich dataset, setting the stage for robust machine learning models.</p>
<section id="key-objectives">
<h2>Key Objectives:<a class="headerlink" href="#key-objectives" title="Link to this heading">#</a></h2>
<p>Data cleaning and imputation are essential steps in the data preprocessing pipeline for several reasons:</p>
<ol class="arabic">
<li><p>Handling Missing Data:</p>
<p>Real-world datasets often contain missing values due to various reasons such as measurement errors, system failures, or human error. Data cleaning and imputation techniques address these gaps, ensuring a complete and usable dataset.</p>
</li>
<li><p>Ensuring Data Quality:</p>
<p>Inaccurate or inconsistent data can significantly impact the performance and reliability of machine learning models. Cleaning the data involves identifying and rectifying errors, ensuring the overall quality and integrity of the dataset.</p>
</li>
<li><p>Mitigating Outliers:</p>
<p>Outliers, or extreme values, can distort statistical analyses and model predictions. Data cleaning involves identifying and handling outliers appropriately, preventing them from unduly influencing the model’s behavior.</p>
</li>
<li><p>Improving Model Performance:</p>
<p>Machine learning algorithms often struggle with missing values and outliers. By cleaning and imputing data, the dataset becomes more suitable for model training, leading to improved performance and generalization on new, unseen data.</p>
</li>
<li><p>Enhancing Data Interpretability:</p>
<p>Clean and well-imputed data fosters a better understanding of the underlying patterns and relationships. Researchers and analysts can trust the results and interpretations derived from a dataset that has undergone thorough cleaning and imputation.</p>
</li>
<li><p>Meeting Assumptions of Statistical Methods:</p>
<p>Many statistical methods assume certain characteristics of the data, such as normal distribution or absence of missing values. Data cleaning ensures that the dataset adheres to these assumptions, allowing for the accurate application of statistical techniques.</p>
</li>
<li><p>Building Trust in Results:</p>
<p>Stakeholders, decision-makers, and users of the machine learning model rely on accurate and trustworthy results. Data cleaning and imputation contribute to the credibility of the model’s outcomes, fostering trust in the decision-making process.</p>
</li>
<li><p>Reducing Bias and Error:</p>
<p>Incomplete or biased datasets can lead to skewed and inaccurate model predictions. Data cleaning minimizes bias, ensuring that the model is trained on a representative and unbiased set of features.</p>
</li>
</ol>
<center>
    <img style="max-width: 670px" src="https://raw.githubusercontent.com/WSU-AI-CyberSecurity/WSU-AI-CyberSecurity.github.io/main/assets/m3_Data-Preprocessing-in-Data.jpg" />
</center>
</section>
<section id="why-data-preprocessing-matters">
<h2>Why Data Preprocessing Matters:<a class="headerlink" href="#why-data-preprocessing-matters" title="Link to this heading">#</a></h2>
<p>Raw data seldom fits neatly into the algorithms we love to employ. Data preprocessing is the unsung hero that transforms raw data into a well-behaved companion, ensuring your models can extract meaningful patterns and insights.</p>
</section>
<section id="visualising-scaling-methods">
<h2>Visualising scaling methods<a class="headerlink" href="#visualising-scaling-methods" title="Link to this heading">#</a></h2>
<p>Let us visulaise what does scaling methods do to the input data. The following are some of the popular preprocessing methods in the <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> library.</p>
<p>The four preprocessing methods—<code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code>, <code class="docutils literal notranslate"><span class="pre">MinMaxScaler</span></code>, <code class="docutils literal notranslate"><span class="pre">Normalizer</span></code>, and <code class="docutils literal notranslate"><span class="pre">RobustScaler</span></code>—from scikit-learn’s <code class="docutils literal notranslate"><span class="pre">preprocessing</span></code> module serve different purposes in preparing and scaling data for machine learning models. Here’s an overview of each:</p>
<ol class="arabic simple">
<li><p><strong>StandardScaler:</strong></p>
<ul class="simple">
<li><p><strong>Method:</strong> <code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code> standardizes features by removing the mean and scaling to unit variance.</p></li>
<li><p><strong>Usage:</strong> It transforms features so that they have a mean of 0 and a standard deviation of 1.</p></li>
<li><p><strong>When to Use:</strong> Suitable for algorithms that assume features follow a Gaussian distribution and for ensuring consistent scales for features.</p></li>
</ul>
</li>
<li><p><strong>MinMaxScaler:</strong></p>
<ul class="simple">
<li><p><strong>Method:</strong> <code class="docutils literal notranslate"><span class="pre">MinMaxScaler</span></code> scales features to a specified range, typically between 0 and 1.</p></li>
<li><p><strong>Usage:</strong> It transforms features, maintaining the original data’s shape while scaling it to a specified range.</p></li>
<li><p><strong>When to Use:</strong> Useful when features need to be on a similar scale, but you want to preserve the original distribution.</p></li>
</ul>
</li>
<li><p><strong>Normalizer:</strong></p>
<ul class="simple">
<li><p><strong>Method:</strong> <code class="docutils literal notranslate"><span class="pre">Normalizer</span></code> scales each sample (row) independently, such that the Euclidean norm (L2 norm) of each row is equal to 1.</p></li>
<li><p><strong>Usage:</strong> It normalizes samples to a unit norm, useful when the direction of each data point is more important than its magnitude.</p></li>
<li><p><strong>When to Use:</strong> Appropriate when working with datasets where the magnitude of the individual samples is crucial.</p></li>
</ul>
</li>
<li><p><strong>RobustScaler:</strong></p>
<ul class="simple">
<li><p><strong>Method:</strong> <code class="docutils literal notranslate"><span class="pre">RobustScaler</span></code> scales features using statistics that are robust to outliers. It uses the median and the interquartile range (IQR).</p></li>
<li><p><strong>Usage:</strong> It scales features while being less affected by outliers compared to <code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code>.</p></li>
<li><p><strong>When to Use:</strong> Suitable when the dataset contains outliers and a more robust scaling method is needed.</p></li>
</ul>
</li>
</ol>
<p>In summary, these preprocessing methods provide flexibility in handling different types of data and scaling requirements. The choice of scaler depends on the characteristics of the data and the assumptions of the machine learning algorithm being used.</p>
<p>In practice, <code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code> is the most typical approach as it requires less assumptions and works well in most scenarios.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_blobs</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">MinMaxScaler</span><span class="p">,</span> <span class="n">Normalizer</span><span class="p">,</span> <span class="n">RobustScaler</span>

<span class="n">cm2</span> <span class="o">=</span> <span class="s2">&quot;bwr&quot;</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">cluster_std</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X</span> <span class="o">+=</span> <span class="mi">3</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">main_ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">main_ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm2</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="n">maxx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">maxy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="n">main_ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="n">maxx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maxx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">main_ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">maxy</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maxy</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">main_ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Original Data&quot;</span><span class="p">)</span>
<span class="n">other_axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">scaler</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
    <span class="n">other_axes</span><span class="p">,</span>
    <span class="p">[</span><span class="n">StandardScaler</span><span class="p">(),</span> <span class="n">RobustScaler</span><span class="p">(),</span> <span class="n">MinMaxScaler</span><span class="p">(),</span> <span class="n">Normalizer</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="s2">&quot;l2&quot;</span><span class="p">)],</span>
<span class="p">):</span>
    <span class="n">X_</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm2</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">scaler</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">other_axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">main_ax</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">other_axes</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3bbb50d0c7a00a3d17035042ed5d99db6d8cec3f170999d4bed1aefba85bd095.png" src="../_images/3bbb50d0c7a00a3d17035042ed5d99db6d8cec3f170999d4bed1aefba85bd095.png" />
</div>
</div>
</section>
<section id="navigating-the-module">
<h2>Navigating the Module:<a class="headerlink" href="#navigating-the-module" title="Link to this heading">#</a></h2>
<p>We encourage you to actively participate in exercises, experiment with the provided code snippets, and explore real-world scenarios. Don’t hesitate to ask questions and engage with your peers – learning is a collaborative journey!</p>
<p>So, gear up for an illuminating exploration of Data Preprocessing and Feature Selection. Let’s refine our data and set the stage for machine learning success!</p>
<section id="imports">
<h3>Imports<a class="headerlink" href="#imports" title="Link to this heading">#</a></h3>
<p>Let’s begin by importing some of the common modules that we’ll be using today.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>

<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

<span class="c1"># Classifiers and regressors</span>
<span class="kn">from</span> <span class="nn">sklearn.dummy</span> <span class="kn">import</span> <span class="n">DummyClassifier</span><span class="p">,</span> <span class="n">DummyRegressor</span>

<span class="c1"># Preprocessing and pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>

<span class="c1"># train test split and cross validation</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">cross_validate</span><span class="p">,</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span><span class="p">,</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">MinMaxScaler</span><span class="p">,</span>
    <span class="n">OneHotEncoder</span><span class="p">,</span>
    <span class="n">OrdinalEncoder</span><span class="p">,</span>
    <span class="n">StandardScaler</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics.pairwise</span> <span class="kn">import</span> <span class="n">euclidean_distances</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">pe</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_colwidth&quot;</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-k-nearest-neighbours-on-the-spotify-dataset">
<h3>Example: <span class="math notranslate nohighlight">\(k\)</span>-nearest neighbours on the Spotify dataset<a class="headerlink" href="#example-k-nearest-neighbours-on-the-spotify-dataset" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Yesterday in our workshop, we’ve used <code class="docutils literal notranslate"><span class="pre">DecisionTreeClassifier</span></code>, and today we will use the same model to predict whether the user would like a particular song or not.</p></li>
<li><p>Intuition: To predict whether the user likes a particular song or not (query point)</p>
<ul>
<li><p>find the songs that are closest to the query point</p></li>
<li><p>let them vote on the target</p></li>
<li><p>take the majority vote as the target for the query point</p></li>
</ul>
</li>
</ul>
<p>We are going to use the <strong>Spotify Song Attributes</strong> dataset from <a class="reference external" href="https://www.kaggle.com/datasets/geomack/spotifyclassification">Kaggle</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spotify_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://raw.githubusercontent.com/WSU-AI-CyberSecurity/data/master/spotify.csv&quot;</span><span class="p">,</span>
    <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">train_df</span><span class="p">,</span> <span class="n">test_df</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">spotify_df</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">train_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;song_title&quot;</span><span class="p">,</span> <span class="s2">&quot;artist&quot;</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span><span class="p">]),</span>
    <span class="n">train_df</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">test_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;song_title&quot;</span><span class="p">,</span> <span class="s2">&quot;artist&quot;</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span><span class="p">]),</span>
    <span class="n">test_df</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let us first define a baseline dummy classifier:</p>
<p>The <code class="docutils literal notranslate"><span class="pre">DummyClassifier</span></code> in scikit-learn is a simple, baseline classifier used for reference and comparison in machine learning tasks. It allows you to create a dummy or baseline model that serves as a basic benchmark to evaluate the performance of more sophisticated models. The primary purpose of <code class="docutils literal notranslate"><span class="pre">DummyClassifier</span></code> is to provide a minimalistic model to compare against when assessing the effectiveness of your machine learning models.</p>
<ul class="simple">
<li><p>In our code, we use <code class="docutils literal notranslate"><span class="pre">most_frequent</span></code>, which means that it will always just predict the most frequent class.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dummy</span> <span class="o">=</span> <span class="n">DummyClassifier</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;most_frequent&quot;</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span><span class="n">dummy</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean validation score </span><span class="si">%0.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="s2">&quot;test_score&quot;</span><span class="p">])))</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean validation score 0.508
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fit_time</th>
      <th>score_time</th>
      <th>test_score</th>
      <th>train_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000531</td>
      <td>0.000377</td>
      <td>0.507740</td>
      <td>0.507752</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.000417</td>
      <td>0.000324</td>
      <td>0.507740</td>
      <td>0.507752</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.000537</td>
      <td>0.000487</td>
      <td>0.507740</td>
      <td>0.507752</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000625</td>
      <td>0.000717</td>
      <td>0.506211</td>
      <td>0.508133</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.000628</td>
      <td>0.000480</td>
      <td>0.509317</td>
      <td>0.507359</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">()</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span><span class="n">knn</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean validation score </span><span class="si">%0.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="s2">&quot;test_score&quot;</span><span class="p">])))</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean validation score 0.546
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fit_time</th>
      <th>score_time</th>
      <th>test_score</th>
      <th>train_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.003458</td>
      <td>0.013423</td>
      <td>0.563467</td>
      <td>0.717829</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.002030</td>
      <td>0.010070</td>
      <td>0.535604</td>
      <td>0.721705</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.002076</td>
      <td>0.010276</td>
      <td>0.529412</td>
      <td>0.708527</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.001925</td>
      <td>0.009448</td>
      <td>0.537267</td>
      <td>0.721921</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.001921</td>
      <td>0.009367</td>
      <td>0.562112</td>
      <td>0.711077</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">two_songs</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;===== This is the distance of the two song by considering the following features =====&quot;</span>
<span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">two_songs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;===== Distance: =====&quot;</span><span class="p">)</span>
<span class="n">euclidean_distances</span><span class="p">(</span><span class="n">two_songs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===== This is the distance of the two song by considering the following features =====
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acousticness</th>
      <th>danceability</th>
      <th>duration_ms</th>
      <th>energy</th>
      <th>instrumentalness</th>
      <th>key</th>
      <th>liveness</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>tempo</th>
      <th>time_signature</th>
      <th>valence</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>842</th>
      <td>0.229000</td>
      <td>0.494</td>
      <td>147893</td>
      <td>0.666</td>
      <td>0.000057</td>
      <td>9</td>
      <td>0.0469</td>
      <td>-9.743</td>
      <td>0</td>
      <td>0.0351</td>
      <td>140.832</td>
      <td>4.0</td>
      <td>0.704</td>
    </tr>
    <tr>
      <th>654</th>
      <td>0.000289</td>
      <td>0.771</td>
      <td>227143</td>
      <td>0.949</td>
      <td>0.602000</td>
      <td>8</td>
      <td>0.5950</td>
      <td>-4.712</td>
      <td>1</td>
      <td>0.1750</td>
      <td>111.959</td>
      <td>4.0</td>
      <td>0.372</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===== Distance: =====
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[    0.        , 79250.00543825],
       [79250.00543825,     0.        ]])
</pre></div>
</div>
</div>
</div>
<p>Let’s consider only two features: <code class="docutils literal notranslate"><span class="pre">duration_ms</span></code> and <code class="docutils literal notranslate"><span class="pre">tempo</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">two_songs_subset</span> <span class="o">=</span> <span class="n">two_songs</span><span class="p">[[</span><span class="s2">&quot;duration_ms&quot;</span><span class="p">,</span> <span class="s2">&quot;tempo&quot;</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;===== This is the distance of the two song by considering the following features =====&quot;</span>
<span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">two_songs_subset</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;===== Distance: =====&quot;</span><span class="p">)</span>
<span class="n">euclidean_distances</span><span class="p">(</span><span class="n">two_songs_subset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===== This is the distance of the two song by considering the following features =====
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>duration_ms</th>
      <th>tempo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>842</th>
      <td>147893</td>
      <td>140.832</td>
    </tr>
    <tr>
      <th>654</th>
      <td>227143</td>
      <td>111.959</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===== Distance: =====
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[    0.        , 79250.00525962],
       [79250.00525962,     0.        ]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="do-you-see-any-problem">
<h3>Do you see any problem?<a class="headerlink" href="#do-you-see-any-problem" title="Link to this heading">#</a></h3>
<p>The distance of the two song, regardless of whether we are considering all features (13 total), or only a subset of features (only 2), have essentially the same value (79250.0054….)</p>
<ul class="simple">
<li><p>The distance is completely dominated by the the features with larger values</p></li>
<li><p>The features with smaller values are being ignored.</p></li>
<li><p>Does it matter?</p>
<ul>
<li><p>Yes! Scale is based on how data was collected.</p></li>
<li><p>Features on a smaller scale can be highly informative and there is no good reason to ignore them.</p></li>
<li><p>We want our model to be robust and not sensitive to the scale.</p></li>
</ul>
</li>
<li><p>Was this a problem for decision trees?</p></li>
</ul>
</section>
<section id="scaling-using-scikit-learn-s-standardscaler">
<h3>Scaling using <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>’s <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html"><code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code></a><a class="headerlink" href="#scaling-using-scikit-learn-s-standardscaler" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>We’ll use <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>’s <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html"><code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code></a>, which is a <code class="docutils literal notranslate"><span class="pre">transformer</span></code>.</p></li>
<li><p>Only focus on the syntax for now. We’ll talk about scaling in a bit.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>  <span class="c1"># create feature trasformer object</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>  <span class="c1"># fitting the transformer on the train split</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>  <span class="c1"># transforming the train split</span>
<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>  <span class="c1"># transforming the test split</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span>  <span class="c1"># original X_train</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acousticness</th>
      <th>danceability</th>
      <th>duration_ms</th>
      <th>energy</th>
      <th>instrumentalness</th>
      <th>key</th>
      <th>liveness</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>tempo</th>
      <th>time_signature</th>
      <th>valence</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1505</th>
      <td>0.004770</td>
      <td>0.585</td>
      <td>214740</td>
      <td>0.614</td>
      <td>0.000155</td>
      <td>10</td>
      <td>0.0762</td>
      <td>-5.594</td>
      <td>0</td>
      <td>0.0370</td>
      <td>114.059</td>
      <td>4.0</td>
      <td>0.2730</td>
    </tr>
    <tr>
      <th>813</th>
      <td>0.114000</td>
      <td>0.665</td>
      <td>216728</td>
      <td>0.513</td>
      <td>0.303000</td>
      <td>0</td>
      <td>0.1220</td>
      <td>-7.314</td>
      <td>1</td>
      <td>0.3310</td>
      <td>100.344</td>
      <td>3.0</td>
      <td>0.0373</td>
    </tr>
    <tr>
      <th>615</th>
      <td>0.030200</td>
      <td>0.798</td>
      <td>216585</td>
      <td>0.481</td>
      <td>0.000000</td>
      <td>7</td>
      <td>0.1280</td>
      <td>-10.488</td>
      <td>1</td>
      <td>0.3140</td>
      <td>127.136</td>
      <td>4.0</td>
      <td>0.6400</td>
    </tr>
    <tr>
      <th>319</th>
      <td>0.106000</td>
      <td>0.912</td>
      <td>194040</td>
      <td>0.317</td>
      <td>0.000208</td>
      <td>6</td>
      <td>0.0723</td>
      <td>-12.719</td>
      <td>0</td>
      <td>0.0378</td>
      <td>99.346</td>
      <td>4.0</td>
      <td>0.9490</td>
    </tr>
    <tr>
      <th>320</th>
      <td>0.021100</td>
      <td>0.697</td>
      <td>236456</td>
      <td>0.905</td>
      <td>0.893000</td>
      <td>6</td>
      <td>0.1190</td>
      <td>-7.787</td>
      <td>0</td>
      <td>0.0339</td>
      <td>119.977</td>
      <td>4.0</td>
      <td>0.3110</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2012</th>
      <td>0.001060</td>
      <td>0.584</td>
      <td>274404</td>
      <td>0.932</td>
      <td>0.002690</td>
      <td>1</td>
      <td>0.1290</td>
      <td>-3.501</td>
      <td>1</td>
      <td>0.3330</td>
      <td>74.976</td>
      <td>4.0</td>
      <td>0.2110</td>
    </tr>
    <tr>
      <th>1346</th>
      <td>0.000021</td>
      <td>0.535</td>
      <td>203500</td>
      <td>0.974</td>
      <td>0.000149</td>
      <td>10</td>
      <td>0.2630</td>
      <td>-3.566</td>
      <td>0</td>
      <td>0.1720</td>
      <td>116.956</td>
      <td>4.0</td>
      <td>0.4310</td>
    </tr>
    <tr>
      <th>1406</th>
      <td>0.503000</td>
      <td>0.410</td>
      <td>256333</td>
      <td>0.648</td>
      <td>0.000000</td>
      <td>7</td>
      <td>0.2190</td>
      <td>-4.469</td>
      <td>1</td>
      <td>0.0362</td>
      <td>60.391</td>
      <td>4.0</td>
      <td>0.3420</td>
    </tr>
    <tr>
      <th>1389</th>
      <td>0.705000</td>
      <td>0.894</td>
      <td>222307</td>
      <td>0.161</td>
      <td>0.003300</td>
      <td>4</td>
      <td>0.3120</td>
      <td>-14.311</td>
      <td>1</td>
      <td>0.0880</td>
      <td>104.968</td>
      <td>4.0</td>
      <td>0.8180</td>
    </tr>
    <tr>
      <th>1534</th>
      <td>0.623000</td>
      <td>0.470</td>
      <td>394920</td>
      <td>0.156</td>
      <td>0.187000</td>
      <td>2</td>
      <td>0.1040</td>
      <td>-17.036</td>
      <td>1</td>
      <td>0.0399</td>
      <td>118.176</td>
      <td>4.0</td>
      <td>0.0591</td>
    </tr>
  </tbody>
</table>
<p>1613 rows × 13 columns</p>
</div></div></div>
</div>
<p>Let’s examine transformed value of the energy feature in the first row.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">[</span><span class="s2">&quot;energy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.614
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s2">&quot;energy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s2">&quot;energy&quot;</span><span class="p">]))</span> <span class="o">/</span> <span class="n">X_train</span><span class="p">[</span><span class="s2">&quot;energy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.3180174485124284
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X_train</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span>
    <span class="mi">3</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>acousticness</th>
      <th>danceability</th>
      <th>duration_ms</th>
      <th>energy</th>
      <th>instrumentalness</th>
      <th>key</th>
      <th>liveness</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>tempo</th>
      <th>time_signature</th>
      <th>valence</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1505</th>
      <td>-0.698</td>
      <td>-0.195</td>
      <td>-0.399</td>
      <td>-0.318</td>
      <td>-0.492</td>
      <td>1.276</td>
      <td>-0.738</td>
      <td>0.396</td>
      <td>-1.281</td>
      <td>-0.618</td>
      <td>-0.294</td>
      <td>0.139</td>
      <td>-0.908</td>
    </tr>
    <tr>
      <th>813</th>
      <td>-0.276</td>
      <td>0.296</td>
      <td>-0.374</td>
      <td>-0.796</td>
      <td>0.598</td>
      <td>-1.487</td>
      <td>-0.439</td>
      <td>-0.052</td>
      <td>0.781</td>
      <td>2.728</td>
      <td>-0.803</td>
      <td>-3.781</td>
      <td>-1.861</td>
    </tr>
    <tr>
      <th>615</th>
      <td>-0.600</td>
      <td>1.111</td>
      <td>-0.376</td>
      <td>-0.947</td>
      <td>-0.493</td>
      <td>0.447</td>
      <td>-0.400</td>
      <td>-0.879</td>
      <td>0.781</td>
      <td>2.535</td>
      <td>0.191</td>
      <td>0.139</td>
      <td>0.576</td>
    </tr>
    <tr>
      <th>319</th>
      <td>-0.307</td>
      <td>1.809</td>
      <td>-0.654</td>
      <td>-1.722</td>
      <td>-0.492</td>
      <td>0.170</td>
      <td>-0.763</td>
      <td>-1.461</td>
      <td>-1.281</td>
      <td>-0.609</td>
      <td>-0.840</td>
      <td>0.139</td>
      <td>1.825</td>
    </tr>
    <tr>
      <th>320</th>
      <td>-0.635</td>
      <td>0.492</td>
      <td>-0.131</td>
      <td>1.057</td>
      <td>2.723</td>
      <td>0.170</td>
      <td>-0.458</td>
      <td>-0.176</td>
      <td>-1.281</td>
      <td>-0.653</td>
      <td>-0.074</td>
      <td>0.139</td>
      <td>-0.754</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="fit-and-transform-paradigm-for-transformers">
<h3><code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">transform</span></code> paradigm for transformers<a class="headerlink" href="#fit-and-transform-paradigm-for-transformers" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sklearn</span></code> uses <code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">transform</span></code> paradigms for feature transformations.</p></li>
<li><p>We <code class="docutils literal notranslate"><span class="pre">fit</span></code> the transformer on the train split and then transform the train split as well as the test split.</p></li>
<li><p>We apply the same transformations on the test split.</p></li>
</ul>
</section>
<section id="sklearn-api-summary-estimators">
<h3><code class="docutils literal notranslate"><span class="pre">sklearn</span></code> API summary: estimators<a class="headerlink" href="#sklearn-api-summary-estimators" title="Link to this heading">#</a></h3>
<p>Suppose <code class="docutils literal notranslate"><span class="pre">model</span></code> is a classification or regression model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">X_train_predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
<p>The StandardScaler from scikit-learn is used to transform and standardize features by removing the mean and scaling to unit variance. Applying StandardScaler is beneficial for several reasons:</p>
<ul class="simple">
<li><p>Sandardization ensures that all features have a mean of 0 and a standard deviation of 1. This normalization is especially important for algorithms that rely on distance metrics, such as k-Nearest Neighbors or Support Vector Machines. It prevents features with larger scales from dominating the learning process.</p></li>
<li><p>Standardizing features helps in comparing the relative importance of different features. It ensures that the coefficients or weights associated with each feature reflect their impact in a more meaningful way.
Robustness to Outliers:</p></li>
<li><p>Standardization is less influenced by outliers compared to some other scaling methods. It is based on the mean and standard deviation, which are less sensitive to extreme values.</p></li>
</ul>
<ul class="simple">
<li><p>Do you expect <code class="docutils literal notranslate"><span class="pre">DummyClassifier</span></code> results to change after scaling the data?</p></li>
<li><p>Let’s check whether scaling makes any difference for <span class="math notranslate nohighlight">\(k\)</span>-NNs.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">knn_unscaled</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">()</span>
<span class="n">knn_unscaled</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train score: </span><span class="si">%0.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">knn_unscaled</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test score: </span><span class="si">%0.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">knn_unscaled</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Train score: 0.726
Test score: 0.552
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">knn_scaled</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">()</span>
<span class="n">knn_scaled</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train score: </span><span class="si">%0.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">knn_scaled</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test score: </span><span class="si">%0.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">knn_scaled</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Train score: 0.798
Test score: 0.686
</pre></div>
</div>
</div>
</div>
<p>The scores with scaled data are better compared to the unscaled data in case of <span class="math notranslate nohighlight">\(k\)</span>-NNs.</p>
</section>
<section id="common-preprocessing-techniques">
<h3>Common preprocessing techniques<a class="headerlink" href="#common-preprocessing-techniques" title="Link to this heading">#</a></h3>
<p>Some commonly performed feature transformation include:</p>
<ul class="simple">
<li><p>Imputation: Tackling missing values</p></li>
<li><p>Scaling: Scaling of numeric features</p></li>
<li><p>One-hot encoding: Tackling categorical variables</p></li>
</ul>
<p>In the next part of this module, we’ll build an ML pipeline using <a class="reference external" href="https://www.kaggle.com/datasets/suraj520/cellular-network-analysis-dataset/code">Cellular Network Analysis Dataset</a>. In the process, we will talk about different feature transformations and how can we apply them so that we do not violate the golden rule.</p>
</section>
</section>
<section id="dataset-splitting-and-baseline">
<h2>Dataset, splitting, and baseline<a class="headerlink" href="#dataset-splitting-and-baseline" title="Link to this heading">#</a></h2>
<p>We’ll be working on <a class="reference external" href="https://www.kaggle.com/datasets/suraj520/cellular-network-analysis-dataset/code">Cellular Network Analysis Dataset</a> to demonstrate these feature transformation techniques. The task is to predict network latency, given a number of features from the collected metrics</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df</span><span class="p">,</span> <span class="n">test_df</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/WSU-AI-CyberSecurity/data/master/signal_metrics.csv&quot;</span><span class="p">),</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span>
<span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">train_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Timestamp</th>
      <th>Locality</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Signal Strength (dBm)</th>
      <th>Signal Quality (%)</th>
      <th>Data Throughput (Mbps)</th>
      <th>Latency (ms)</th>
      <th>Network Type</th>
      <th>BB60C Measurement (dBm)</th>
      <th>srsRAN Measurement (dBm)</th>
      <th>BladeRFxA9 Measurement (dBm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11286</th>
      <td>2023-05-29 23:44:54.012478</td>
      <td>Patliputra Colony</td>
      <td>25.573834</td>
      <td>85.174773</td>
      <td>-88.823204</td>
      <td>0.0</td>
      <td>2.633925</td>
      <td>118.470369</td>
      <td>LTE</td>
      <td>-90.679320</td>
      <td>-97.310913</td>
      <td>-91.341579</td>
    </tr>
    <tr>
      <th>11445</th>
      <td>2023-05-30 08:01:00.429985</td>
      <td>Anandpuri</td>
      <td>25.459679</td>
      <td>85.100593</td>
      <td>-84.338977</td>
      <td>0.0</td>
      <td>8.230689</td>
      <td>62.104584</td>
      <td>4G</td>
      <td>-85.669232</td>
      <td>-90.443197</td>
      <td>-83.662386</td>
    </tr>
    <tr>
      <th>8991</th>
      <td>2023-05-25 00:24:06.665443</td>
      <td>Kidwaipuri</td>
      <td>25.718163</td>
      <td>85.164846</td>
      <td>-95.165973</td>
      <td>0.0</td>
      <td>27.416884</td>
      <td>39.535036</td>
      <td>5G</td>
      <td>-92.364076</td>
      <td>-101.027782</td>
      <td>-92.289394</td>
    </tr>
    <tr>
      <th>13062</th>
      <td>2023-06-02 20:06:19.279726</td>
      <td>Rajendra Nagar</td>
      <td>25.646589</td>
      <td>85.123178</td>
      <td>-82.277196</td>
      <td>0.0</td>
      <td>2.681432</td>
      <td>128.228075</td>
      <td>LTE</td>
      <td>-78.858775</td>
      <td>-89.006250</td>
      <td>-84.283168</td>
    </tr>
    <tr>
      <th>4151</th>
      <td>2023-05-14 12:42:29.428123</td>
      <td>Kidwaipuri</td>
      <td>25.687754</td>
      <td>85.008608</td>
      <td>-89.665566</td>
      <td>0.0</td>
      <td>4.607886</td>
      <td>66.139469</td>
      <td>4G</td>
      <td>-90.044765</td>
      <td>-96.717788</td>
      <td>-87.254787</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s have a look at our dataset attributes and the kind of features that it contains:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 15146 entries, 11286 to 15725
Data columns (total 12 columns):
 #   Column                        Non-Null Count  Dtype  
---  ------                        --------------  -----  
 0   Timestamp                     15146 non-null  object 
 1   Locality                      15146 non-null  object 
 2   Latitude                      15146 non-null  float64
 3   Longitude                     15146 non-null  float64
 4   Signal Strength (dBm)         15146 non-null  float64
 5   Signal Quality (%)            15146 non-null  float64
 6   Data Throughput (Mbps)        15146 non-null  float64
 7   Latency (ms)                  15146 non-null  float64
 8   Network Type                  15146 non-null  object 
 9   BB60C Measurement (dBm)       15146 non-null  float64
 10  srsRAN Measurement (dBm)      15146 non-null  float64
 11  BladeRFxA9 Measurement (dBm)  15146 non-null  float64
dtypes: float64(9), object(3)
memory usage: 1.5+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;Locality&quot;</span><span class="p">])</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;Locality&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<section id="eda">
<h3>EDA<a class="headerlink" href="#eda" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 15146 entries, 11286 to 15725
Data columns (total 10 columns):
 #   Column                        Non-Null Count  Dtype  
---  ------                        --------------  -----  
 0   Latitude                      15146 non-null  float64
 1   Longitude                     15146 non-null  float64
 2   Signal Strength (dBm)         15146 non-null  float64
 3   Signal Quality (%)            15146 non-null  float64
 4   Data Throughput (Mbps)        15146 non-null  float64
 5   Latency (ms)                  15146 non-null  float64
 6   Network Type                  15146 non-null  object 
 7   BB60C Measurement (dBm)       15146 non-null  float64
 8   srsRAN Measurement (dBm)      15146 non-null  float64
 9   BladeRFxA9 Measurement (dBm)  15146 non-null  float64
dtypes: float64(9), object(1)
memory usage: 1.3+ MB
</pre></div>
</div>
</div>
</div>
<p>We have one categorical feature and all other features are numeric features.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Signal Strength (dBm)</th>
      <th>Signal Quality (%)</th>
      <th>Data Throughput (Mbps)</th>
      <th>Latency (ms)</th>
      <th>BB60C Measurement (dBm)</th>
      <th>srsRAN Measurement (dBm)</th>
      <th>BladeRFxA9 Measurement (dBm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>15146.000000</td>
      <td>15146.000000</td>
      <td>15146.000000</td>
      <td>15146.0</td>
      <td>15146.000000</td>
      <td>15146.000000</td>
      <td>15146.000000</td>
      <td>15146.000000</td>
      <td>15146.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>25.594919</td>
      <td>85.137158</td>
      <td>-90.060175</td>
      <td>0.0</td>
      <td>16.116261</td>
      <td>101.407733</td>
      <td>-68.567118</td>
      <td>-74.165153</td>
      <td>-68.567884</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.089658</td>
      <td>0.090057</td>
      <td>5.399430</td>
      <td>0.0</td>
      <td>25.620021</td>
      <td>55.980000</td>
      <td>40.197141</td>
      <td>43.377956</td>
      <td>40.147603</td>
    </tr>
    <tr>
      <th>min</th>
      <td>25.414575</td>
      <td>84.957936</td>
      <td>-113.082820</td>
      <td>0.0</td>
      <td>1.000423</td>
      <td>10.019527</td>
      <td>-115.667514</td>
      <td>-121.598760</td>
      <td>-114.683401</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>25.523497</td>
      <td>85.064075</td>
      <td>-93.595083</td>
      <td>0.0</td>
      <td>2.001390</td>
      <td>50.430155</td>
      <td>-94.022080</td>
      <td>-101.224898</td>
      <td>-93.744037</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>25.595584</td>
      <td>85.138149</td>
      <td>-89.641736</td>
      <td>0.0</td>
      <td>2.992287</td>
      <td>100.451793</td>
      <td>-89.112998</td>
      <td>-96.801157</td>
      <td>-89.263101</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>25.667371</td>
      <td>85.209626</td>
      <td>-86.117291</td>
      <td>0.0</td>
      <td>9.933834</td>
      <td>150.029733</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>25.773648</td>
      <td>85.316994</td>
      <td>-74.644848</td>
      <td>0.0</td>
      <td>99.985831</td>
      <td>199.991081</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## (optional)</span>
<span class="n">train_df</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[&lt;Axes: title={&#39;center&#39;: &#39;Latitude&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Longitude&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Signal Strength (dBm)&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;Signal Quality (%)&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Data Throughput (Mbps)&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Latency (ms)&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;BB60C Measurement (dBm)&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;srsRAN Measurement (dBm)&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;BladeRFxA9 Measurement (dBm)&#39;}&gt;]],
      dtype=object)
</pre></div>
</div>
<img alt="../_images/999cc3d72917571d40b90dcf886edd34a3274bfdc42d34e00deda0c0e3c6d4ce.png" src="../_images/999cc3d72917571d40b90dcf886edd34a3274bfdc42d34e00deda0c0e3c6d4ce.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">scatter_mapbox</span><span class="p">(</span>
    <span class="n">train_df</span><span class="p">[</span><span class="n">train_df</span><span class="p">[</span><span class="s2">&quot;Network Type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;5G&quot;</span><span class="p">],</span>
    <span class="n">lat</span><span class="o">=</span><span class="s2">&quot;Latitude&quot;</span><span class="p">,</span>
    <span class="n">lon</span><span class="o">=</span><span class="s2">&quot;Longitude&quot;</span><span class="p">,</span>
    <span class="n">mapbox_style</span><span class="o">=</span><span class="s2">&quot;open-street-map&quot;</span><span class="p">,</span>
    <span class="n">opacity</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Signal Strength (dBm)&quot;</span><span class="p">,</span>
    <span class="c1"># color=&#39;BladeRFxA9 Measurement (dBm)&#39;,</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">margin</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2d6114d6b904ac3ec6bcd43cb504aa63f4b3f30926fdfaf9da41f01176793dd0.png" src="../_images/2d6114d6b904ac3ec6bcd43cb504aa63f4b3f30926fdfaf9da41f01176793dd0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">data_frame</span><span class="o">=</span><span class="n">train_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Network Type&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Network Type&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Signal Strength (dBm)&quot;</span><span class="p">,</span> <span class="s2">&quot;Data Throughput (Mbps)&quot;</span><span class="p">,</span> <span class="s2">&quot;Latency (ms)&quot;</span><span class="p">],</span>
    <span class="n">barmode</span><span class="o">=</span><span class="s2">&quot;group&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Mean attributes grouped-by Netrowk Types (3G, 4G, 5G, LTE)&quot;</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ea1230e7f98ad1af62dfcfe5735752e5540d1858e7649d486c542f09af34a5eb.png" src="../_images/ea1230e7f98ad1af62dfcfe5735752e5540d1858e7649d486c542f09af34a5eb.png" />
</div>
</div>
</section>
<section id="what-all-transformations-we-need-to-apply-on-the-dataset">
<h3>What all transformations we need to apply on the dataset?<a class="headerlink" href="#what-all-transformations-we-need-to-apply-on-the-dataset" title="Link to this heading">#</a></h3>
<p>Here is what we see from the EDA.</p>
<ul class="simple">
<li><p>Scales are quite different across columns.</p></li>
<li><p>Categorical variable <code class="docutils literal notranslate"><span class="pre">Network</span> <span class="pre">Type</span></code></p></li>
</ul>
<p>Read about <a class="reference external" href="https://scikit-learn.org/stable/modules/preprocessing.html">preprocessing techniques implemented in <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Latency (ms)&quot;</span><span class="p">,</span> <span class="s2">&quot;Network Type&quot;</span><span class="p">])</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="s2">&quot;Latency (ms)&quot;</span><span class="p">]</span>

<span class="n">X_test</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Latency (ms)&quot;</span><span class="p">,</span> <span class="s2">&quot;Network Type&quot;</span><span class="p">])</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="s2">&quot;Latency (ms)&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="let-s-first-run-our-baseline-model-dummyregressor">
<h3>Let’s first run our baseline model <code class="docutils literal notranslate"><span class="pre">DummyRegressor</span></code><a class="headerlink" href="#let-s-first-run-our-baseline-model-dummyregressor" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_dict</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># dictionary to store our results for different models</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mean_std_cross_val_scores</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns mean and std of cross validation</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model :</span>
<span class="sd">        scikit-learn model</span>
<span class="sd">    X_train : numpy array or pandas DataFrame</span>
<span class="sd">        X in the training data</span>
<span class="sd">    y_train :</span>
<span class="sd">        y in the training data</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">        pandas Series with mean scores from cross_validation</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">scores</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">mean_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">std_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">out_col</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mean_scores</span><span class="p">)):</span>
        <span class="n">out_col</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="sa">f</span><span class="s2">&quot;%0.3f (+/- %0.3f)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean_scores</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">std_scores</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">out_col</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">mean_scores</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_train</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11286    118.470369
11445     62.104584
8991      39.535036
13062    128.228075
4151      66.139469
            ...    
96        31.932823
13435    109.640342
7763     101.868511
15377     21.659666
15725    177.697604
Name: Latency (ms), Length: 15146, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dummy</span> <span class="o">=</span> <span class="n">DummyRegressor</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">)</span>
<span class="n">results_dict</span><span class="p">[</span><span class="s2">&quot;dummy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_std_cross_val_scores</span><span class="p">(</span>
    <span class="n">dummy</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_245424/4158382658.py:26: FutureWarning:

Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dummy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>fit_time</th>
      <td>0.001 (+/- 0.000)</td>
    </tr>
    <tr>
      <th>score_time</th>
      <td>0.000 (+/- 0.000)</td>
    </tr>
    <tr>
      <th>test_score</th>
      <td>-0.001 (+/- 0.000)</td>
    </tr>
    <tr>
      <th>train_score</th>
      <td>-0.000 (+/- 0.000)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="scaling">
<h3>Scaling<a class="headerlink" href="#scaling" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>This problem affects a large number of ML methods.</p></li>
<li><p>A number of approaches to this problem. We are going to look into the most popular ones.</p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Approach</p></th>
<th class="head"><p>What it does</p></th>
<th class="head"><p>How to update <span class="math notranslate nohighlight">\(X\)</span> (but see below!)</p></th>
<th class="head"><p>sklearn implementation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>standardization</p></td>
<td><p>sets sample mean to <span class="math notranslate nohighlight">\(0\)</span>, s.d. to <span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">-=</span> <span class="pre">np.mean(X,axis=0)</span></code><br><code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">/=</span>&#160; <span class="pre">np.std(X,axis=0)</span></code></p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html#sklearn.preprocessing.StandardScaler"><code class="docutils literal notranslate"><span class="pre">StandardScaler()</span></code></a></p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Signal Strength (dBm)</th>
      <th>Signal Quality (%)</th>
      <th>Data Throughput (Mbps)</th>
      <th>BB60C Measurement (dBm)</th>
      <th>srsRAN Measurement (dBm)</th>
      <th>BladeRFxA9 Measurement (dBm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.235178</td>
      <td>0.417697</td>
      <td>0.229100</td>
      <td>0.0</td>
      <td>-0.526260</td>
      <td>-0.550112</td>
      <td>-0.533601</td>
      <td>-0.567268</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.508445</td>
      <td>-0.406029</td>
      <td>1.059628</td>
      <td>0.0</td>
      <td>-0.307800</td>
      <td>-0.425470</td>
      <td>-0.375273</td>
      <td>-0.375988</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.374633</td>
      <td>0.307469</td>
      <td>-0.945649</td>
      <td>0.0</td>
      <td>0.441100</td>
      <td>-0.592026</td>
      <td>-0.619290</td>
      <td>-0.590877</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.576312</td>
      <td>-0.155235</td>
      <td>1.441492</td>
      <td>0.0</td>
      <td>-0.524405</td>
      <td>-0.256038</td>
      <td>-0.342146</td>
      <td>-0.391451</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.035463</td>
      <td>-1.427470</td>
      <td>0.073086</td>
      <td>0.0</td>
      <td>-0.449209</td>
      <td>-0.534325</td>
      <td>-0.519927</td>
      <td>-0.465470</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>15141</th>
      <td>-1.249304</td>
      <td>0.776592</td>
      <td>-1.054591</td>
      <td>0.0</td>
      <td>2.334350</td>
      <td>-0.768915</td>
      <td>-0.626568</td>
      <td>-0.693106</td>
    </tr>
    <tr>
      <th>15142</th>
      <td>0.476210</td>
      <td>-0.607609</td>
      <td>-0.557700</td>
      <td>0.0</td>
      <td>-0.557237</td>
      <td>-0.696676</td>
      <td>-0.616269</td>
      <td>-0.633682</td>
    </tr>
    <tr>
      <th>15143</th>
      <td>-0.753742</td>
      <td>-1.671379</td>
      <td>0.533930</td>
      <td>0.0</td>
      <td>-0.585827</td>
      <td>-0.485844</td>
      <td>-0.451067</td>
      <td>-0.472370</td>
    </tr>
    <tr>
      <th>15144</th>
      <td>1.234431</td>
      <td>-0.034641</td>
      <td>-2.463528</td>
      <td>0.0</td>
      <td>0.052647</td>
      <td>-0.826386</td>
      <td>-0.863319</td>
      <td>-0.896739</td>
    </tr>
    <tr>
      <th>15145</th>
      <td>1.171396</td>
      <td>0.741267</td>
      <td>0.508109</td>
      <td>0.0</td>
      <td>-0.578728</td>
      <td>1.705827</td>
      <td>1.709799</td>
      <td>1.707951</td>
    </tr>
  </tbody>
</table>
<p>15146 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">()</span>
<span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">knn</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7797007360451268
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Big difference in the KNN training performance after scaling the data.</p></li>
<li><p>But we saw last week that training score doesn’t tell us much. We should look at the cross-validation score.</p></li>
</ul>
</section>
</section>
<section id="feature-transformations-and-the-golden-rule">
<h2>Feature transformations and the golden rule<a class="headerlink" href="#feature-transformations-and-the-golden-rule" title="Link to this heading">#</a></h2>
<p>Let’s try cross-validation with transformed data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">()</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span><span class="n">knn</span><span class="p">,</span> <span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fit_time</th>
      <th>score_time</th>
      <th>test_score</th>
      <th>train_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.008447</td>
      <td>0.028756</td>
      <td>0.669859</td>
      <td>0.773023</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.008505</td>
      <td>0.029550</td>
      <td>0.657948</td>
      <td>0.774226</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.008446</td>
      <td>0.028970</td>
      <td>0.657192</td>
      <td>0.772506</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.008358</td>
      <td>0.028327</td>
      <td>0.646960</td>
      <td>0.775659</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.008291</td>
      <td>0.029188</td>
      <td>0.647245</td>
      <td>0.774178</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Do you see any problem here?</p></li>
<li><p>Are we applying <code class="docutils literal notranslate"><span class="pre">fit_transform</span></code> on train portion and <code class="docutils literal notranslate"><span class="pre">transform</span></code> on validation portion in each fold?</p>
<ul>
<li><p>Here you might be allowing information from the validation set to <strong>leak</strong> into the training step.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>You need to apply the <strong>SAME</strong> preprocessing steps to train/validation.</p></li>
<li><p>With many different transformations and cross validation the code gets unwieldy very quickly.</p></li>
<li><p>Likely to make mistakes and “leak” information.</p></li>
</ul>
<ul class="simple">
<li><p>In these examples our test accuracies look fine, but our methodology is flawed.</p></li>
<li><p>Implications can be significant in practice!</p></li>
</ul>
<section id="pipelines">
<h3>Pipelines<a class="headerlink" href="#pipelines" title="Link to this heading">#</a></h3>
<p>Can we do this in a more elegant and organized way?</p>
<ul class="simple">
<li><p>YES!! Using <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html"><code class="docutils literal notranslate"><span class="pre">scikit-learn</span> <span class="pre">Pipeline</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html"><code class="docutils literal notranslate"><span class="pre">scikit-learn</span> <span class="pre">Pipeline</span></code></a> allows you to define a “pipeline” of transformers with a final estimator.</p></li>
</ul>
<p>Let’s combine the preprocessing and model with pipeline</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Simple example of a pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
    <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;imputer&quot;</span><span class="p">,</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;scaler&quot;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
        <span class="p">(</span><span class="s2">&quot;regressor&quot;</span><span class="p">,</span> <span class="n">KNeighborsRegressor</span><span class="p">()),</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Syntax: pass in a list of steps.</p></li>
<li><p>The last step should be a <strong>model/classifier/regressor</strong>.</p></li>
<li><p>All the earlier steps should be <strong>transformers</strong>.</p></li>
</ul>
</section>
<section id="alternative-and-more-compact-syntax-make-pipeline">
<h3>Alternative and more compact syntax: <code class="docutils literal notranslate"><span class="pre">make_pipeline</span></code><a class="headerlink" href="#alternative-and-more-compact-syntax-make-pipeline" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Shorthand for <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code> constructor</p></li>
<li><p>Does not permit naming steps</p></li>
<li><p>Instead the names of steps are set to lowercase of their types automatically; <code class="docutils literal notranslate"><span class="pre">StandardScaler()</span></code> would be named as <code class="docutils literal notranslate"><span class="pre">standardscaler</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span>
    <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">),</span> <span class="n">StandardScaler</span><span class="p">(),</span> <span class="n">KNeighborsRegressor</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-5 {color: black;}#sk-container-id-5 pre{padding: 0;}#sk-container-id-5 div.sk-toggleable {background-color: white;}#sk-container-id-5 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-5 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-5 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-5 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-5 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-5 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-5 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-5 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-5 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-5 div.sk-item {position: relative;z-index: 1;}#sk-container-id-5 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-5 div.sk-item::before, #sk-container-id-5 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-5 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-5 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-5 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-5 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-5 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-5 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-5 div.sk-label-container {text-align: center;}#sk-container-id-5 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-5 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-5" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[(&#x27;simpleimputer&#x27;, SimpleImputer(strategy=&#x27;median&#x27;)),
                (&#x27;standardscaler&#x27;, StandardScaler()),
                (&#x27;kneighborsregressor&#x27;, KNeighborsRegressor())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-17" type="checkbox" ><label for="sk-estimator-id-17" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;simpleimputer&#x27;, SimpleImputer(strategy=&#x27;median&#x27;)),
                (&#x27;standardscaler&#x27;, StandardScaler()),
                (&#x27;kneighborsregressor&#x27;, KNeighborsRegressor())])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-18" type="checkbox" ><label for="sk-estimator-id-18" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy=&#x27;median&#x27;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-19" type="checkbox" ><label for="sk-estimator-id-19" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-20" type="checkbox" ><label for="sk-estimator-id-20" class="sk-toggleable__label sk-toggleable__label-arrow">KNeighborsRegressor</label><div class="sk-toggleable__content"><pre>KNeighborsRegressor()</pre></div></div></div></div></div></div></div></div></div>
</div>
<p>When you call <code class="docutils literal notranslate"><span class="pre">fit</span></code> on the pipeline, it carries out the following steps:</p>
<ul class="simple">
<li><p>Fit <code class="docutils literal notranslate"><span class="pre">SimpleImputer</span></code> on <code class="docutils literal notranslate"><span class="pre">X_train</span></code></p></li>
<li><p>Transform <code class="docutils literal notranslate"><span class="pre">X_train</span></code> using the fit <code class="docutils literal notranslate"><span class="pre">SimpleImputer</span></code> to create <code class="docutils literal notranslate"><span class="pre">X_train</span></code></p></li>
<li><p>Fit <code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code> on <code class="docutils literal notranslate"><span class="pre">X_train</span></code></p></li>
<li><p>Transform <code class="docutils literal notranslate"><span class="pre">X_train</span></code> using the fit <code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code></p></li>
<li><p>Fit the model (<code class="docutils literal notranslate"><span class="pre">KNeighborsRegressor</span></code> in our case)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([120.28679471,  75.96071876,  29.21442221, ..., 142.46425035,
        44.20921845, 166.92819945])
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://raw.githubusercontent.com/WSU-AI-CyberSecurity/WSU-AI-CyberSecurity.github.io/main/assets/m3_pipeline.png" /></p>
</section>
<section id="let-s-try-cross-validation-with-our-pipeline">
<h3>Let’s try cross-validation with our pipeline<a class="headerlink" href="#let-s-try-cross-validation-with-our-pipeline" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_dict</span><span class="p">[</span><span class="s2">&quot;imp + scaling + knn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_std_cross_val_scores</span><span class="p">(</span>
    <span class="n">pipe</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results_dict</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_245424/4158382658.py:26: FutureWarning:

Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fit_time</th>
      <th>score_time</th>
      <th>test_score</th>
      <th>train_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>dummy</th>
      <td>0.001 (+/- 0.000)</td>
      <td>0.000 (+/- 0.000)</td>
      <td>-0.001 (+/- 0.000)</td>
      <td>-0.000 (+/- 0.000)</td>
    </tr>
    <tr>
      <th>imp + scaling + knn</th>
      <td>0.017 (+/- 0.002)</td>
      <td>0.030 (+/- 0.000)</td>
      <td>0.656 (+/- 0.010)</td>
      <td>0.774 (+/- 0.001)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Using a <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code> takes care of applying the <code class="docutils literal notranslate"><span class="pre">fit_transform</span></code> on the train portion and only <code class="docutils literal notranslate"><span class="pre">transform</span></code> on the validation portion in each fold.</p>
</section>
</section>
<section id="categorical-features">
<h2>Categorical features<a class="headerlink" href="#categorical-features" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Recall that we had dropped the categorical feature <code class="docutils literal notranslate"><span class="pre">Network</span> <span class="pre">Type</span></code> feature from the dataframe. But it could potentially be a useful feature in this task.</p></li>
<li><p>Let’s create our <code class="docutils literal notranslate"><span class="pre">X_train</span></code> and and <code class="docutils literal notranslate"><span class="pre">X_test</span></code> again by keeping the feature in the data.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Signal Strength (dBm)</th>
      <th>Signal Quality (%)</th>
      <th>Data Throughput (Mbps)</th>
      <th>BB60C Measurement (dBm)</th>
      <th>srsRAN Measurement (dBm)</th>
      <th>BladeRFxA9 Measurement (dBm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11286</th>
      <td>25.573834</td>
      <td>85.174773</td>
      <td>-88.823204</td>
      <td>0.0</td>
      <td>2.633925</td>
      <td>-90.679320</td>
      <td>-97.310913</td>
      <td>-91.341579</td>
    </tr>
    <tr>
      <th>11445</th>
      <td>25.459679</td>
      <td>85.100593</td>
      <td>-84.338977</td>
      <td>0.0</td>
      <td>8.230689</td>
      <td>-85.669232</td>
      <td>-90.443197</td>
      <td>-83.662386</td>
    </tr>
    <tr>
      <th>8991</th>
      <td>25.718163</td>
      <td>85.164846</td>
      <td>-95.165973</td>
      <td>0.0</td>
      <td>27.416884</td>
      <td>-92.364076</td>
      <td>-101.027782</td>
      <td>-92.289394</td>
    </tr>
    <tr>
      <th>13062</th>
      <td>25.646589</td>
      <td>85.123178</td>
      <td>-82.277196</td>
      <td>0.0</td>
      <td>2.681432</td>
      <td>-78.858775</td>
      <td>-89.006250</td>
      <td>-84.283168</td>
    </tr>
    <tr>
      <th>4151</th>
      <td>25.687754</td>
      <td>85.008608</td>
      <td>-89.665566</td>
      <td>0.0</td>
      <td>4.607886</td>
      <td>-90.044765</td>
      <td>-96.717788</td>
      <td>-87.254787</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>96</th>
      <td>25.482912</td>
      <td>85.207093</td>
      <td>-95.754178</td>
      <td>0.0</td>
      <td>75.920386</td>
      <td>-99.474296</td>
      <td>-101.343500</td>
      <td>-96.393491</td>
    </tr>
    <tr>
      <th>13435</th>
      <td>25.637614</td>
      <td>85.082440</td>
      <td>-93.071336</td>
      <td>0.0</td>
      <td>1.840301</td>
      <td>-96.570589</td>
      <td>-100.896749</td>
      <td>-94.007852</td>
    </tr>
    <tr>
      <th>7763</th>
      <td>25.527342</td>
      <td>84.986643</td>
      <td>-87.177355</td>
      <td>0.0</td>
      <td>1.107868</td>
      <td>-88.096014</td>
      <td>-93.730885</td>
      <td>-87.531770</td>
    </tr>
    <tr>
      <th>15377</th>
      <td>25.705593</td>
      <td>85.134038</td>
      <td>-103.361381</td>
      <td>0.0</td>
      <td>17.465030</td>
      <td>-101.784379</td>
      <td>-111.612911</td>
      <td>-104.568606</td>
    </tr>
    <tr>
      <th>15725</th>
      <td>25.699941</td>
      <td>85.203912</td>
      <td>-87.316766</td>
      <td>0.0</td>
      <td>1.289739</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>15146 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Latency (ms)&quot;</span><span class="p">])</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="s2">&quot;Latency (ms)&quot;</span><span class="p">]</span>

<span class="n">X_test</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Latency (ms)&quot;</span><span class="p">])</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="s2">&quot;Latency (ms)&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Let’s try to build a <code class="docutils literal notranslate"><span class="pre">KNeighborRegressor</span></code> on this data using our pipeline</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pipe.fit(X_train, y_train)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>This failed because we have non-numeric data.</p></li>
<li><p>Imagine how <span class="math notranslate nohighlight">\(k\)</span>-NN would calculate distances when you have non-numeric features.</p></li>
</ul>
<section id="can-we-use-this-feature-in-the-model">
<h3>Can we use this feature in the model?<a class="headerlink" href="#can-we-use-this-feature-in-the-model" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>In <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>, most algorithms require numeric inputs.</p></li>
<li><p>Decision trees could theoretically work with categorical features.</p>
<ul>
<li><p>However, the sklearn implementation does not support this.</p></li>
</ul>
</li>
</ul>
</section>
<section id="what-are-the-options">
<h3>What are the options?<a class="headerlink" href="#what-are-the-options" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Drop the column (not recommended)</p>
<ul>
<li><p>If you know that the column is not relevant to the target in any way you may drop it.</p></li>
</ul>
</li>
<li><p>We can transform categorical features to numeric ones so that we can use them in the model.</p>
<ul>
<li><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OrdinalEncoder.html">Ordinal encoding</a> (occasionally recommended)</p></li>
<li><p>One-hot encoding (recommended in most cases)</p></li>
</ul>
</li>
</ul>
<section id="one-hot-encoding-ohe">
<h4>One-hot encoding (OHE)<a class="headerlink" href="#one-hot-encoding-ohe" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Create new binary columns to represent our categories.</p></li>
<li><p>If we have <span class="math notranslate nohighlight">\(c\)</span> categories in our column.</p>
<ul>
<li><p>We create <span class="math notranslate nohighlight">\(c\)</span> new binary columns to represent those categories.</p></li>
</ul>
</li>
<li><p>Example: Imagine a language column which has the information on whether you</p></li>
<li><p>We can use sklearn’s <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html"><code class="docutils literal notranslate"><span class="pre">OneHotEncoder</span></code></a> to do so.</p></li>
</ul>
<p>One-hot encoding is called one-hot because only one of the newly created features is 1 for each data point.</p>
</section>
</section>
<section id="let-s-do-it-on-our-dataset">
<h3>Let’s do it on our dataset<a class="headerlink" href="#let-s-do-it-on-our-dataset" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ohe</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
<span class="n">ohe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">[[</span><span class="s2">&quot;Network Type&quot;</span><span class="p">]])</span>
<span class="n">X_imp_ohe_train</span> <span class="o">=</span> <span class="n">ohe</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">[[</span><span class="s2">&quot;Network Type&quot;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>We can look at the new features created using <code class="docutils literal notranslate"><span class="pre">categories_</span></code> attribute</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ohe</span><span class="o">.</span><span class="n">categories_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[array([&#39;3G&#39;, &#39;4G&#39;, &#39;5G&#39;, &#39;LTE&#39;], dtype=object)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">transformed_ohe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">X_imp_ohe_train</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span><span class="n">ohe</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">([</span><span class="s2">&quot;Network Type&quot;</span><span class="p">]),</span>
    <span class="n">index</span><span class="o">=</span><span class="n">X_train</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">transformed_ohe</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Network Type_3G</th>
      <th>Network Type_4G</th>
      <th>Network Type_5G</th>
      <th>Network Type_LTE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11286</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11445</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8991</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>13062</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4151</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>96</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>13435</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7763</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>15377</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>15725</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>15146 rows × 4 columns</p>
</div></div></div>
</div>
<p>One-hot encoded variables are also referred to as <strong>dummy variables</strong>.
You will often see people using <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.get_dummies.html"><code class="docutils literal notranslate"><span class="pre">get_dummies</span></code> method of pandas</a> to convert categorical variables into dummy variables. That said, using <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>’s <code class="docutils literal notranslate"><span class="pre">OneHotEncoder</span></code> has the advantage of making it easy to treat training and test set in a consistent way.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_onehot</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Latency (ms)&quot;</span><span class="p">,</span> <span class="s2">&quot;Network Type&quot;</span><span class="p">])</span>
<span class="n">X_train_onehot</span><span class="p">[</span><span class="n">ohe</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">([</span><span class="s2">&quot;Network Type&quot;</span><span class="p">])]</span> <span class="o">=</span> <span class="n">ohe</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
    <span class="n">train_df</span><span class="p">[[</span><span class="s2">&quot;Network Type&quot;</span><span class="p">]]</span>
<span class="p">)</span>
<span class="n">y_train_onehot</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="s2">&quot;Latency (ms)&quot;</span><span class="p">]</span>

<span class="n">X_test_onehot</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Latency (ms)&quot;</span><span class="p">,</span> <span class="s2">&quot;Network Type&quot;</span><span class="p">])</span>
<span class="n">X_test_onehot</span><span class="p">[</span><span class="n">ohe</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">([</span><span class="s2">&quot;Network Type&quot;</span><span class="p">])]</span> <span class="o">=</span> <span class="n">ohe</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
    <span class="n">test_df</span><span class="p">[[</span><span class="s2">&quot;Network Type&quot;</span><span class="p">]]</span>
<span class="p">)</span>
<span class="n">y_test_onehot</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="s2">&quot;Latency (ms)&quot;</span><span class="p">]</span>

<span class="n">display</span><span class="p">(</span><span class="n">X_train_onehot</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">display</span><span class="p">(</span><span class="n">X_test_onehot</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Signal Strength (dBm)</th>
      <th>Signal Quality (%)</th>
      <th>Data Throughput (Mbps)</th>
      <th>BB60C Measurement (dBm)</th>
      <th>srsRAN Measurement (dBm)</th>
      <th>BladeRFxA9 Measurement (dBm)</th>
      <th>Network Type_3G</th>
      <th>Network Type_4G</th>
      <th>Network Type_5G</th>
      <th>Network Type_LTE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11286</th>
      <td>25.573834</td>
      <td>85.174773</td>
      <td>-88.823204</td>
      <td>0.0</td>
      <td>2.633925</td>
      <td>-90.679320</td>
      <td>-97.310913</td>
      <td>-91.341579</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11445</th>
      <td>25.459679</td>
      <td>85.100593</td>
      <td>-84.338977</td>
      <td>0.0</td>
      <td>8.230689</td>
      <td>-85.669232</td>
      <td>-90.443197</td>
      <td>-83.662386</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8991</th>
      <td>25.718163</td>
      <td>85.164846</td>
      <td>-95.165973</td>
      <td>0.0</td>
      <td>27.416884</td>
      <td>-92.364076</td>
      <td>-101.027782</td>
      <td>-92.289394</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>13062</th>
      <td>25.646589</td>
      <td>85.123178</td>
      <td>-82.277196</td>
      <td>0.0</td>
      <td>2.681432</td>
      <td>-78.858775</td>
      <td>-89.006250</td>
      <td>-84.283168</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4151</th>
      <td>25.687754</td>
      <td>85.008608</td>
      <td>-89.665566</td>
      <td>0.0</td>
      <td>4.607886</td>
      <td>-90.044765</td>
      <td>-96.717788</td>
      <td>-87.254787</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Signal Strength (dBm)</th>
      <th>Signal Quality (%)</th>
      <th>Data Throughput (Mbps)</th>
      <th>BB60C Measurement (dBm)</th>
      <th>srsRAN Measurement (dBm)</th>
      <th>BladeRFxA9 Measurement (dBm)</th>
      <th>Network Type_3G</th>
      <th>Network Type_4G</th>
      <th>Network Type_5G</th>
      <th>Network Type_LTE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9330</th>
      <td>25.570543</td>
      <td>85.083773</td>
      <td>-93.993151</td>
      <td>0.0</td>
      <td>32.993816</td>
      <td>-89.317574</td>
      <td>-102.051970</td>
      <td>-95.512645</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9444</th>
      <td>25.482447</td>
      <td>85.252053</td>
      <td>-85.403792</td>
      <td>0.0</td>
      <td>1.324703</td>
      <td>-80.892173</td>
      <td>-90.616113</td>
      <td>-84.190972</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>10747</th>
      <td>25.654413</td>
      <td>84.995628</td>
      <td>-85.801469</td>
      <td>0.0</td>
      <td>3.386222</td>
      <td>-81.167757</td>
      <td>-91.211866</td>
      <td>-82.921993</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>14890</th>
      <td>25.652035</td>
      <td>84.982229</td>
      <td>-85.958410</td>
      <td>0.0</td>
      <td>2.626279</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6965</th>
      <td>25.428545</td>
      <td>85.090492</td>
      <td>-96.360206</td>
      <td>0.0</td>
      <td>98.067846</td>
      <td>-94.388360</td>
      <td>-105.694470</td>
      <td>-93.704065</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe_onehot</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span>
    <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">),</span> <span class="n">StandardScaler</span><span class="p">(),</span> <span class="n">KNeighborsRegressor</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">pipe_onehot</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_onehot</span><span class="p">,</span> <span class="n">y_train_onehot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-6 {color: black;}#sk-container-id-6 pre{padding: 0;}#sk-container-id-6 div.sk-toggleable {background-color: white;}#sk-container-id-6 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-6 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-6 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-6 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-6 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-6 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-6 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-6 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-6 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-6 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-6 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-6 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-6 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-6 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-6 div.sk-item {position: relative;z-index: 1;}#sk-container-id-6 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-6 div.sk-item::before, #sk-container-id-6 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-6 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-6 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-6 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-6 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-6 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-6 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-6 div.sk-label-container {text-align: center;}#sk-container-id-6 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-6 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-6" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[(&#x27;simpleimputer&#x27;, SimpleImputer(strategy=&#x27;median&#x27;)),
                (&#x27;standardscaler&#x27;, StandardScaler()),
                (&#x27;kneighborsregressor&#x27;, KNeighborsRegressor())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-21" type="checkbox" ><label for="sk-estimator-id-21" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;simpleimputer&#x27;, SimpleImputer(strategy=&#x27;median&#x27;)),
                (&#x27;standardscaler&#x27;, StandardScaler()),
                (&#x27;kneighborsregressor&#x27;, KNeighborsRegressor())])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-22" type="checkbox" ><label for="sk-estimator-id-22" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy=&#x27;median&#x27;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-23" type="checkbox" ><label for="sk-estimator-id-23" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-24" type="checkbox" ><label for="sk-estimator-id-24" class="sk-toggleable__label sk-toggleable__label-arrow">KNeighborsRegressor</label><div class="sk-toggleable__content"><pre>KNeighborsRegressor()</pre></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_dict</span><span class="p">[</span><span class="s2">&quot;imp + scaling + knn + onehot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_std_cross_val_scores</span><span class="p">(</span>
    <span class="n">pipe_onehot</span><span class="p">,</span> <span class="n">X_train_onehot</span><span class="p">,</span> <span class="n">y_train_onehot</span><span class="p">,</span> <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results_dict</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_245424/4158382658.py:26: FutureWarning:

Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fit_time</th>
      <th>score_time</th>
      <th>test_score</th>
      <th>train_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>dummy</th>
      <td>0.001 (+/- 0.000)</td>
      <td>0.000 (+/- 0.000)</td>
      <td>-0.001 (+/- 0.000)</td>
      <td>-0.000 (+/- 0.000)</td>
    </tr>
    <tr>
      <th>imp + scaling + knn</th>
      <td>0.017 (+/- 0.002)</td>
      <td>0.030 (+/- 0.000)</td>
      <td>0.656 (+/- 0.010)</td>
      <td>0.774 (+/- 0.001)</td>
    </tr>
    <tr>
      <th>imp + scaling + knn + onehot</th>
      <td>0.024 (+/- 0.002)</td>
      <td>0.037 (+/- 0.001)</td>
      <td>0.802 (+/- 0.004)</td>
      <td>0.867 (+/- 0.001)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="what-did-we-learn-with-this-module">
<h2>What did we learn with this module?<a class="headerlink" href="#what-did-we-learn-with-this-module" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Motivation for preprocessing</p></li>
<li><p>Common preprocessing steps</p>
<ul>
<li><p>Imputation</p></li>
<li><p>Scaling</p></li>
<li><p>One-hot encoding</p></li>
</ul>
</li>
<li><p>Golden rule in the context of preprocessing</p></li>
<li><p>Building simple supervised machine learning pipelines using <code class="docutils literal notranslate"><span class="pre">sklearn.pipeline.make_pipeline</span></code>.</p></li>
</ul>
<section id="problem-different-transformations-on-different-columns">
<h3>Problem: Different transformations on different columns<a class="headerlink" href="#problem-different-transformations-on-different-columns" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>How do we put this together with other columns in the data before fitting the regressor?</p></li>
<li><p>Before we fit our regressor, we want to apply different transformations on different columns</p>
<ul>
<li><p>Numeric columns</p>
<ul>
<li><p>imputation</p></li>
<li><p>scaling</p></li>
</ul>
</li>
<li><p>Categorical columns</p>
<ul>
<li><p>imputation</p></li>
<li><p>one-hot encoding</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Module_2_Supervised_learning.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Module 2:</strong> Supervised Learning</p>
      </div>
    </a>
    <a class="right-next"
       href="Module_4_Unsupervised_Learning.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>Module 4</strong>: Unsupervised Learning</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-objectives">Key Objectives:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-data-preprocessing-matters">Why Data Preprocessing Matters:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualising-scaling-methods">Visualising scaling methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#navigating-the-module">Navigating the Module:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-k-nearest-neighbours-on-the-spotify-dataset">Example: <span class="math notranslate nohighlight">\(k\)</span>-nearest neighbours on the Spotify dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#do-you-see-any-problem">Do you see any problem?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scaling-using-scikit-learn-s-standardscaler">Scaling using <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>’s <code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fit-and-transform-paradigm-for-transformers"><code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">transform</span></code> paradigm for transformers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sklearn-api-summary-estimators"><code class="docutils literal notranslate"><span class="pre">sklearn</span></code> API summary: estimators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-preprocessing-techniques">Common preprocessing techniques</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-splitting-and-baseline">Dataset, splitting, and baseline</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eda">EDA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-all-transformations-we-need-to-apply-on-the-dataset">What all transformations we need to apply on the dataset?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-first-run-our-baseline-model-dummyregressor">Let’s first run our baseline model <code class="docutils literal notranslate"><span class="pre">DummyRegressor</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scaling">Scaling</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-transformations-and-the-golden-rule">Feature transformations and the golden rule</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pipelines">Pipelines</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#alternative-and-more-compact-syntax-make-pipeline">Alternative and more compact syntax: <code class="docutils literal notranslate"><span class="pre">make_pipeline</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-try-cross-validation-with-our-pipeline">Let’s try cross-validation with our pipeline</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#categorical-features">Categorical features</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#can-we-use-this-feature-in-the-model">Can we use this feature in the model?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-are-the-options">What are the options?</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#one-hot-encoding-ohe">One-hot encoding (OHE)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-do-it-on-our-dataset">Let’s do it on our dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-did-we-learn-with-this-module">What did we learn with this module?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-different-transformations-on-different-columns">Problem: Different transformations on different columns</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By WSU Staffs
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>